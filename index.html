<!DOCTYPE html>
<html lang="pt-BR" class="">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>An√°lise de Perfil Integrado</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- O script de configura√ß√£o do Tailwind deve vir DEPOIS do script da biblioteca principal -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    keyframes: {
                        'fade-in': {
                            '0%': { opacity: '0', transform: 'translateY(10px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        },
                        'pulse-icon': {
                            '0%, 100%': { transform: 'scale(1)', opacity: '1' },
                            '50%': { transform: 'scale(1.1)', opacity: '0.8' },
                        },
                        'float': {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        'reveal': {
                            '0%': { opacity: '0', transform: 'scale(0.5)' },
                            '100%': { opacity: '1', transform: 'scale(1)' },
                        },
                        'spin-roulette': {
                            '0%': { transform: 'rotate(0deg)' },
                            '100%': { transform: 'rotate(1080deg)' },
                        }
                    },
                    animation: {
                        'fade-in': 'fade-in 0.5s ease-out forwards',
                        'pulse-icon': 'pulse-icon 2s ease-in-out infinite',
                        'float': 'float 3s ease-in-out infinite',
                        'reveal': 'reveal 0.5s ease-out forwards',
                        'spin-roulette': 'spin-roulette 3.2s cubic-bezier(0.15, 0.85, 0.45, 1) forwards'
                    }
                }
            }
        }
    </script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        .question-card { animation: fade-in 0.5s ease-out forwards; }
        .modal-backdrop { transition: opacity 0.3s ease; }
        #share-card-wrapper {
            position: fixed;
            left: -9999px; 
            top: 0;
            z-index: -100;
        }
        .pdf-page-break {
            page-break-before: always;
        }
        .icon-circle-container {
            width: 300px;
            height: 300px;
        }
        .icon-item {
            width: 64px;
            height: 64px;
            transition: transform 0.3s ease;
        }
        .icon-item:hover {
            transform: scale(1.1);
        }
        .analyzing-icon {
            opacity: 0;
            animation: reveal 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 antialiased transition-colors duration-300 overflow-x-hidden">

    <div id="app" class="container mx-auto max-w-5xl p-4 sm:p-6 md:p-8 min-h-screen flex flex-col justify-center">
        
        <div class="absolute top-4 right-4 z-10">
            <button id="theme-toggle" class="p-2 rounded-full bg-white/50 dark:bg-gray-800/50 backdrop-blur-sm text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900 focus:ring-blue-500">
                <svg id="theme-icon-sun" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                <svg id="theme-icon-moon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
            </button>
        </div>
        
        <div id="start-screen" class="text-center">
            <div class="relative icon-circle-container mx-auto mb-8 flex items-center justify-center">
                <div class="absolute text-7xl font-bold text-gray-300 dark:text-gray-700 animate-pulse">?</div>
                <!-- Icons will be placed here by JS -->
            </div>
            <h1 class="text-4xl sm:text-5xl font-extrabold text-gray-900 dark:text-white mb-4">Desvende Seu Perfil</h1>
            <p class="text-lg text-gray-600 dark:text-gray-300 mb-8 max-w-xl mx-auto">Uma jornada em duas etapas para revelar como voc√™ age, se comunica e aprende.</p>
            <div class="mb-6">
                <input type="text" id="name-input" placeholder="Digite seu nome aqui..." class="w-full max-w-md px-5 py-4 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white transition text-center text-lg">
            </div>
            <button id="start-btn" class="bg-blue-600 text-white font-bold py-4 px-10 rounded-xl hover:bg-blue-700 transition-all duration-300 shadow-lg transform hover:scale-105 text-lg">
                Iniciar Jornada
            </button>
            <div class="absolute bottom-4 right-4">
                <button id="admin-btn" class="p-2 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 focus:outline-none">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path></svg>
                </button>
            </div>
        </div>
        
        <div id="transition-screen" class="hidden text-center animate-fade-in">
            <div class="text-6xl mb-6">‚úÖ</div>
            <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white mb-4">Etapa 1 Conclu√≠da!</h2>
            <p class="text-lg text-gray-600 dark:text-gray-300 mb-8 max-w-xl mx-auto">Excelente! Agora, vamos para a segunda parte para entendermos seus canais de comunica√ß√£o e aprendizado.</p>
            <button id="start-vak-btn" class="bg-teal-600 text-white font-bold py-4 px-10 rounded-xl hover:bg-teal-700 transition-all duration-300 shadow-lg transform hover:scale-105 text-lg">
                Continuar
            </button>
        </div>

        <div id="quiz-screen" class="hidden w-full max-w-4xl mx-auto">
            <div id="quiz-header" class="text-center mb-4">
                 <h2 id="quiz-title" class="text-2xl font-bold text-blue-600 dark:text-blue-400"></h2>
            </div>
            <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5 mb-4">
                <div id="progress-bar" class="bg-blue-600 h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
            <div class="text-center mb-8">
                <p class="text-gray-600 dark:text-gray-400 font-semibold">Pergunta <span id="question-counter">1</span> de <span id="total-questions">25</span></p>
            </div>
            <div id="question-container"></div>
            <div class="flex justify-between mt-8">
                 <button id="prev-btn" class="bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-gray-200 font-bold py-3 px-8 rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors duration-300">Anterior</button>
                 <button id="next-btn" class="bg-blue-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-blue-700 transition-colors duration-300">Pr√≥xima</button>
            </div>
        </div>
        
        <div id="analyzing-screen" class="hidden text-center">
            <div id="analyzing-icons-container" class="relative icon-circle-container mx-auto mb-8 flex items-center justify-center">
                 <!-- Animated icons will be placed here by JS -->
            </div>
            <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white mt-6">Integrando seus Perfis...</h2>
            <p class="text-lg text-gray-600 dark:text-gray-300">Estamos a construir o seu mapa de personalidade completo.</p>
        </div>

        <div id="results-screen" class="hidden w-full"></div>

        <div id="answer-key-screen" class="hidden w-full max-w-5xl mx-auto bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg">
            <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white mb-6 text-center">Gabarito do Perfil Comportamental</h2>
            <div class="overflow-x-auto mb-12">
                <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                        <tr>
                            <th scope="col" class="py-3 px-6">#</th>
                            <th scope="col" class="py-3 px-6">√Åguia ü¶Ö (I)</th>
                            <th scope="col" class="py-3 px-6">Gato üêà (C)</th>
                            <th scope="col" class="py-3 px-6">Lobo üê∫ (O)</th>
                            <th scope="col" class="py-3 px-6">Tubar√£o ü¶à (A)</th>
                        </tr>
                    </thead>
                    <tbody id="answer-key-body">
                    </tbody>
                </table>
            </div>

            <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white mb-6 text-center">Gabarito do Teste de Canais</h2>
            <div class="overflow-x-auto">
                <table class="w-full text-sm text-left text-gray-500 dark:text-gray-400">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                        <tr>
                            <th scope="col" class="py-3 px-6">#</th>
                            <th scope="col" class="py-3 px-6">Afirma√ß√£o</th>
                            <th scope="col" class="py-3 px-6">Canal (se 'Sim')</th>
                        </tr>
                    </thead>
                    <tbody id="answer-key-body-vak">
                    </tbody>
                </table>
            </div>

            <div class="mt-8 text-center">
                <button id="close-answer-key-btn" class="bg-gray-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-gray-600 transition-all duration-300 shadow-md">Fechar Gabarito</button>
            </div>
        </div>
        
        <footer class="text-center text-sm text-gray-500 dark:text-gray-400 mt-8">
            <p>¬© 2025 Diego Karloh. Todos os direitos reservados.</p>
        </footer>

    </div>

    <!-- Modals -->
    <div id="validation-modal" class="modal-backdrop hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 opacity-0">
        <div class="modal-content bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-xl text-center max-w-sm w-full">
            <h3 class="text-xl font-bold mb-4">Aten√ß√£o!</h3>
            <p id="modal-message" class="mb-6"></p>
            <button id="modal-close-btn" class="bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition">OK</button>
        </div>
    </div>
     <div id="password-modal" class="modal-backdrop hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 opacity-0">
        <div class="modal-content bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-xl text-center max-w-sm w-full">
            <h3 class="text-xl font-bold mb-4">Acesso Restrito</h3>
            <p class="mb-4 text-gray-600 dark:text-gray-300">Por favor, insira a senha para ver o gabarito.</p>
            <input type="password" id="password-input" class="w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-gray-50 dark:bg-gray-700 mb-4">
            <div class="flex gap-4">
                <button id="password-cancel-btn" class="w-full bg-gray-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-600 transition">Cancelar</button>
                <button id="password-submit-btn" class="w-full bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Entrar</button>
            </div>
        </div>
    </div>
    <div id="resume-modal" class="modal-backdrop hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 opacity-0">
        <div class="modal-content bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-xl text-center max-w-sm w-full">
            <h3 class="text-xl font-bold mb-4">Continuar de onde parou?</h3>
            <p id="resume-message" class="mb-6 text-gray-600 dark:text-gray-300"></p>
            <div class="flex gap-4">
                <button id="resume-new-btn" class="w-full bg-gray-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-600 transition">Come√ßar de Novo</button>
                <button id="resume-continue-btn" class="w-full bg-blue-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-blue-700 transition">Continuar</button>
            </div>
        </div>
    </div>
    <div id="function-modal" class="modal-backdrop hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 opacity-0">
         <div class="modal-content bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-xl text-left max-w-md w-full">
            <h3 id="function-modal-title" class="text-2xl font-bold mb-4 text-center"></h3>
            <div class="space-y-4">
                <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-700">
                    <h4 class="text-lg font-bold text-green-800 dark:text-green-300 mb-2">Pontos Fortes na √Årea</h4>
                    <ul id="function-modal-strengths" class="text-gray-700 dark:text-gray-300 space-y-2"></ul>
                </div>
                <div class="bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-700">
                    <h4 class="text-lg font-bold text-yellow-800 dark:text-yellow-300 mb-2">Pontos a Melhorar na √Årea</h4>
                    <ul id="function-modal-weaknesses" class="text-gray-700 dark:text-gray-300 space-y-2"></ul>
                </div>
            </div>
            <button id="function-modal-close-btn" class="mt-6 w-full bg-gray-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-600 transition">Fechar</button>
        </div>
    </div>
     <div id="interaction-modal" class="modal-backdrop hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 opacity-0">
         <div class="modal-content bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-xl text-left max-w-md w-full">
            <h3 id="interaction-modal-title" class="text-2xl font-bold mb-4 text-center"></h3>
            <div class="space-y-4">
                <div class="bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-700">
                    <h4 class="text-lg font-bold text-green-800 dark:text-green-300 mb-2">Sinergias</h4>
                    <p id="interaction-modal-synergy" class="text-gray-700 dark:text-gray-300"></p>
                </div>
                <div class="bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg border border-yellow-200 dark:border-yellow-700">
                    <h4 class="text-lg font-bold text-yellow-800 dark:text-yellow-300 mb-2">Pontos de Aten√ß√£o</h4>
                    <p id="interaction-modal-attention" class="text-gray-700 dark:text-gray-300"></p>
                </div>
            </div>
            <button id="interaction-modal-close-btn" class="mt-6 w-full bg-gray-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-600 transition">Fechar</button>
        </div>
    </div>

    <div id="share-card-wrapper">
        <div id="share-card" class="bg-white p-6 w-[450px]">
            <h2 id="share-card-name" class="text-2xl font-bold text-center text-gray-800 mb-1"></h2>
            <p id="share-card-title" class="text-center text-indigo-500 font-bold text-lg"></p>
            <p id="share-card-superpower" class="text-center text-gray-600 text-sm mb-2"></p>
            
            <h3 class="text-center text-gray-800 font-bold mt-3 text-base">Perfil Comportamental</h3>
            <div class="flex items-center gap-4">
                <div id="share-card-chart" class="w-1/2 h-40 mx-auto"></div>
                <div id="share-card-percentages" class="w-1/2 grid grid-cols-1 gap-y-1 text-sm text-gray-700"></div>
            </div>
            
            <h3 class="text-center text-gray-800 font-bold mt-4 text-base">Canais de Comunica√ß√£o</h3>
            <div id="share-card-vak-chart" class="w-full h-24 mx-auto mt-1"></div>

             <div class="mt-4 text-center text-xs text-gray-500">
                Fa√ßa sua an√°lise completa!
            </div>
        </div>
    </div>
    
    <script>
        // --- DADOS DOS TESTES ---
        const profileTestQuestions = [
            { question: "1. Eu sou...", options: [ { text: "Idealista, criativo e vision√°rio", profile: "I" }, { text: "Divertido, espiritual e ben√©fico", profile: "C" }, { text: "Confi√°vel, meticuloso e previs√≠vel", profile: "O" }, { text: "Focado, determinado e persistente", profile: "A" } ] },
            { question: "2. Eu gosto de...", options: [ { text: "Ser piloto", profile: "A" }, { text: "Conversar com os passageiros", profile: "C" }, { text: "Planejar a viagem", profile: "O" }, { text: "Explorar novas rotas", profile: "I" } ] },
            { question: "3. Se voc√™ quiser se dar bem comigo...", options: [ { text: "Me d√™ liberdade", profile: "I" }, { text: "Me deixe saber sua expectativa", profile: "O" }, { text: "Seja amig√°vel, carinhoso e compreensivo", profile: "C" }, { text: "Lidere, siga ou saia do caminho", profile: "A" } ] },
            { question: "4. Para conseguir obter bons resultados √© preciso...", options: [ { text: "Ter incertezas", profile: "I" }, { text: "Controlar o essencial", profile: "A" }, { text: "Divers√£o e celebra√ß√£o", profile: "C" }, { text: "Planejar e obter recursos", profile: "O" } ] },
            { question: "5. Eu me divirto quando...", options: [ { text: "Estou me exercitando", profile: "A" }, { text: "Tenho novidades", profile: "I" }, { text: "Estou com os outros", profile: "C" }, { text: "Determino as regras", profile: "O" } ] },
            { question: "6. Eu penso que...", options: [ { text: "Unidos venceremos, divididos perderemos", profile: "C" }, { text: "O ataque √© melhor que a defesa", profile: "A" }, { text: "√â bom ser manso, mas andar com porrete", profile: "I" }, { text: "Um homem prevenido vale por dois", profile: "O" } ] },
            { question: "7. Minha preocupa√ß√£o √©...", options: [ { text: "Gerar a ideia global", profile: "I" }, { text: "Fazer com que as pessoas gostem", profile: "C" }, { text: "Fazer com que funcione", profile: "O" }, { text: "Fazer com que aconte√ßa", profile: "A" } ] },
            { question: "8. Eu prefiro...", options: [ { text: "Perguntas a respostas", profile: "I" }, { text: "Ter todos os detalhes", profile: "O" }, { text: "Vantagens a meu favor", profile: "A" }, { text: "Que todos tenham a chance de ser ouvidos", profile: "C" } ] },
            { question: "9. Eu gosto de...", options: [ { text: "Fazer progresso", profile: "A" }, { text: "Construir mem√≥rias", profile: "C" }, { text: "Fazer sentido", profile: "O" }, { text: "Tornar as pessoas confort√°veis", profile: "I" } ] },
            { question: "10. Eu gosto de chegar...", options: [ { text: "Na frente", profile: "A" }, { text: "Junto", profile: "C" }, { text: "Na hora", profile: "O" }, { text: "Em outro lugar", profile: "I" } ] },
            { question: "11. Um √≥timo dia para mim √© quando...", options: [ { text: "Consigo fazer muitas coisas", profile: "A" }, { text: "Me divirto com meus amigos", profile: "C" }, { text: "Tudo segue conforme planejado", profile: "O" }, { text: "Desfruto de coisas novas e estimulantes", profile: "I" } ] },
            { question: "12. Eu vejo a morte como...", options: [ { text: "Uma grande aventura misteriosa", profile: "I" }, { text: "Oportunidade para rever os falecidos", profile: "C" }, { text: "Um modo de receber recompensas", profile: "A" }, { text: "Algo que sempre chega muito cedo", profile: "O" } ] },
            { question: "13. Minha filosofia de vida √©...", options: [ { text: "H√° ganhadores e perdedores, e eu acredito ser um ganhador", profile: "A" }, { text: "Para eu ganhar, ningu√©m precisa perder", profile: "C" }, { text: "Para ganhar √© preciso seguir as regras", profile: "O" }, { text: "Para ganhar, √© necess√°rio inventar novas regras", profile: "I" } ] },
            { question: "14. Eu sempre gostei de...", options: [ { text: "Explorar", profile: "I" }, { text: "Evitar surpresas", profile: "O" }, { text: "Focalizar a meta", profile: "A" }, { text: "Realizar uma abordagem natural", profile: "C" } ] },
            { question: "15. Eu gosto de mudan√ßas se...", options: [ { text: "Me der uma vantagem competitiva", profile: "A" }, { text: "For divertido e puder ser compartilhado", profile: "C" }, { text: "Me der mais liberdade e variedade", profile: "I" }, { text: "Melhorar ou me der mais controle", profile: "O" } ] },
            { question: "16. N√£o existe nada de errado em...", options: [ { text: "Se colocar na frente", profile: "A" }, { text: "Colocar os outros na frente", profile: "C" }, { text: "Mudar de ideia", profile: "I" }, { text: "Ser consistente", profile: "O" } ] },
            { question: "17. Eu gosto de buscar conselhos de...", options: [ { text: "Pessoas bem-sucedidas", profile: "A" }, { text: "Anci√£os e conselheiros", profile: "C" }, { text: "Autoridades no assunto", profile: "O" }, { text: "Lugares, os mais estranhos", profile: "I" } ] },
            { question: "18. Meu lema √©...", options: [ { text: "Fazer o que precisa ser feito", profile: "A" }, { text: "Fazer bem feito", profile: "O" }, { text: "Fazer junto com o grupo", profile: "C" }, { text: "Simplesmente fazer", profile: "I" } ] },
            { question: "19. Eu gosto de...", options: [ { text: "Complexidade, mesmo que confuso", profile: "I" }, { text: "Ordem e sistematiza√ß√£o", profile: "O" }, { text: "Calor humano e anima√ß√£o", profile: "C" }, { text: "Coisas claras e simples", profile: "A" } ] },
            { "question": "20. Tempo para mim √©...", "options": [ { text: "Algo que detesto desperdi√ßar", profile: "A" }, { text: "Um grande ciclo", profile: "C" }, { text: "Uma flecha que leva ao inevit√°vel", profile: "O" }, { text: "Irrelevante", profile: "I" } ] },
            { "question": "21. Se eu fosse bilion√°rio...", "options": [ { text: "Faria doa√ß√µes para muitas entidades", profile: "C" }, { text: "Criaria uma poupan√ßa avantajada", profile: "O" }, { text: "Faria o que desse na cabe√ßa", profile: "I" }, { text: "Exibiria bastante com algumas pessoas", profile: "A" } ] },
            { "question": "22. Eu acredito que...", "options": [ { text: "O destino √© mais importante que a jornada", profile: "A" }, { text: "A jornada √© mais importante que o destino", profile: "C" }, { text: "Um centavo economizado √© um centavo ganho", profile: "O" }, { text: "Bastam um navio e uma estrela para navegar", profile: "I" } ] },
            { "question": "23. Eu acredito tamb√©m que...", "options": [ { text: "Aquele que hesita est√° perdido", profile: "A" }, { text: "De gr√£o em gr√£o a galinha enche o papo", profile: "O" }, { text: "O que vai, volta", profile: "C" }, { text: "Um sorriso ou uma careta √© o mesmo para quem √© cego", profile: "I" } ] },
            { "question": "24. Eu acredito ainda que...", "options": [ { text: "√â melhor prud√™ncia do que arrependimento", profile: "O" }, { text: "A autoindulg√™ncia √© perdo√°vel", profile: "I" }, { text: "O saber √© fundamental", profile: "A" }, { text: "O coletivo √© mais importante do que o individual", profile: "C" } ] },
            { "question": "25. Eu penso que...", "options": [ { text: "N√£o √© f√°cil ficar encurralado", profile: "A" }, { text: "√â prefer√≠vel olhar, antes de pular", profile: "O" }, { text: "Duas cabe√ßas pensam melhor do que uma", profile: "C" }, { text: "Se voc√™ n√£o tem condi√ß√µes de competir, n√£o compita", profile: "I" } ] }
        ];
        const vakTestQuestions = [
            { series: 'V', text: "Escrevo listas daquilo que tenho de fazer." }, { series: 'V', text: "Realizo coisas desde que as instru√ß√µes escritas sejam bem detalhadas." }, { series: 'V', text: "Gosto de fazer palavras cruzadas." }, { series: 'V', text: "Gosto de exposi√ß√µes e de museus." }, { series: 'V', text: "Localizo-me com facilidade, numa cidade nova, se eu tiver um mapa." }, { series: 'V', text: "Todos os meses assisto a uns filmes." }, { series: 'V', text: "N√£o tenho boa impress√£o de algu√©m, se estiver mal vestido." }, { series: 'V', text: "Gosto de observar as pessoas." }, { series: 'V', text: "Acho que flores realmente embelezam a casa e o escrit√≥rio." }, { series: 'V', text: "Mando consertar os arranh√µes do meu carro o mais r√°pido poss√≠vel." },
            { series: 'AU', text: "Gosto de longas conversas." }, { series: 'AU', text: "Gosto de programas de entrevistas, no r√°dio e na tv." }, { series: 'AU', text: "Sou bom ouvinte." }, { series: 'AU', text: "Prefiro os notici√°rios de r√°dio e TV do que jornais e revistas." }, { series: 'AU', text: "Sinto-me mal quando meu carro faz algum barulho diferente." }, { series: 'AU', text: "Quando ou√ßo m√∫sica presto muita aten√ß√£o √† letra." }, { series: 'AU', text: "Posso dizer muito sobre algu√©m somente pelo seu tom de voz." }, { series: 'AU', text: "Prefiro fazer uma palestra a escrever sobre um assunto." }, { series: 'AU', text: "As pessoas dizem que, √†s vezes, falo demais." }, { series: 'AU', text: "Costumo conversar comigo mesmo ou com meu gato/c√£o." },
            { series: 'K', text: "Quando ou√ßo m√∫sica, n√£o consigo deixar de mexer as m√£os e os p√©s." }, { series: 'K', text: "Gosto muito de estar ao ar livre." }, { series: 'K', text: "Tenho boa coordena√ß√£o motora." }, { series: 'K', text: "Tenho tend√™ncia a ganhar peso." }, { series: 'K', text: "Gosto de criar animais de estima√ß√£o." }, { series: 'K', text: "Toco as pessoas quando converso." }, { series: 'K', text: "Gosto mais de praticar esportes do que assistir a eles." }, { series: 'K', text: "Adoro banho, piscina, sauna." }, { series: 'K', text: "Gosto de levantar-me e espregui√ßar-me com frequ√™ncia." }, { series: 'K', text: "Posso dizer muito sobre uma pessoa atrav√©s do seu aperto de m√£o." }
        ];

        // --- DICION√ÅRIOS DE DADOS ---
        const profilesData = {
            A: { name: 'Tubar√£o', emoji: 'ü¶à', color: 'bg-red-500', description: "Focado em resultados e a√ß√£o. √â direto, assertivo, competitivo e determinado. Gosta de desafios e √© r√°pido na tomada de decis√µes.", underPressure: "Sob press√£o, pode tornar-se impaciente, autorit√°rio e assumir riscos desnecess√°rios para acelerar os resultados." },
            O: { name: 'Lobo', emoji: 'üê∫', color: 'bg-gray-500', description: "Organizado, estrat√©gico e detalhista. Gosta de planear, seguir regras e procura a seguran√ßa e a qualidade em tudo o que faz.", underPressure: "Tende a tornar-se excessivamente cr√≠tico, r√≠gido com as regras e resistente a qualquer mudan√ßa de plano." },
            C: { name: 'Gato', emoji: 'üêà', color: 'bg-yellow-500', description: "Comunicativo, soci√°vel e valoriza os relacionamentos. Gosta de trabalhar em equipe, √© emp√°tico, persuasivo e procura a harmonia.", underPressure: "Evita conflitos a todo o custo, pode ter dificuldade em tomar decis√µes dif√≠ceis e pode prometer mais do que consegue entregar para agradar." },
            I: { name: '√Åguia', emoji: 'ü¶Ö', color: 'bg-blue-500', description: "Criativo, vision√°rio e intuitivo. Gosta de inovar, pensar no futuro e ter liberdade de a√ß√£o. √â curioso e procura novas possibilidades.", underPressure: "Pode tornar-se desorganizado, perder o foco nos detalhes importantes e ter dificuldade em cumprir rotinas." },
        };
        const vakProfileData = {
            V: { name: "Visual", emoji: "üëÅÔ∏è", color: 'bg-sky-500', description: "Pessoas com canal visual dominante s√£o ligadas √† est√©tica, formas e detalhes. Processam o mundo atrav√©s do que veem, preferindo gr√°ficos e demonstra√ß√µes a longos textos. Para elas, √© preciso 'ver para crer'." },
            AU: { name: "Auditivo", emoji: "üëÇ", color: 'bg-teal-500', description: "Pessoas com canal auditivo dominante valorizam o di√°logo, o bom senso e a l√≥gica dos argumentos. Aprendem e se comunicam melhor ao ouvir e falar, e s√£o sens√≠veis ao tom de voz e √† clareza da mensagem." },
            K: { name: "Cinest√©sico", emoji: "üñêÔ∏è", color: 'bg-orange-500', description: "Pessoas com canal cinest√©sico dominante processam o mundo atrav√©s de sensa√ß√µes, movimento e da pr√°tica. Valorizam o conforto, o bem-estar e aprendem fazendo, experimentando e sentindo as coisas." }
        };
        const profileCombinations = {
            'A-O': { title: "Executor Estrat√©gico", desc: "A sua determina√ß√£o de Tubar√£o √© equilibrada pela organiza√ß√£o do Lobo. Voc√™ n√£o apenas alcan√ßa metas, mas f√°-lo de forma planeada e com alta qualidade, sendo ideal para liderar projetos complexos." },
            'A-C': { title: "L√≠der Carism√°tico", desc: "A for√ßa do Tubar√£o, combinada com a comunica√ß√£o do Gato, cria um l√≠der que inspira. Voc√™ motiva equipes a alcan√ßar resultados ambiciosos, mantendo um ambiente positivo e colaborativo." },
            'A-I': { title: "Pioneiro Vision√°rio", desc: "A sua ousadia de Tubar√£o √© potencializada pela criatividade da √Åguia. Voc√™ √© excelente a transformar ideias inovadoras em neg√≥cios concretos, liderando o caminho em novos mercados." },
            'O-A': { title: "Organizador Eficiente", desc: "Com a meticulosidade do Lobo e a praticidade do Tubar√£o, voc√™ cria sistemas e processos que entregam resultados consistentes e de alta performance." },
            'O-C': { title: "Planeador Colaborativo", desc: "A organiza√ß√£o do Lobo e a habilidade de relacionamento do Gato fazem de si um pilar para a equipe. Voc√™ estrutura o trabalho e garante que todos estejam engajados e em harmonia." },
            'O-I': { title: "Arquiteto Inovador", desc: "A vis√£o da √Åguia encontra a precis√£o do Lobo. Voc√™ √© capaz de desenhar solu√ß√µes criativas e garantir que elas sejam implementadas com perfei√ß√£o e aten√ß√£o aos detalhes." },
            'C-A': { title: "Negociador Persuasivo", desc: "O seu carisma de Gato, apoiado pela assertividade do Tubar√£o, torna-o um negociador nato, excelente a fechar acordos e a construir parcerias estrat√©gicas." },
            'C-O': { title: "Gestor de Pessoas", desc: "A empatia do Gato com a ordem do Lobo cria um gestor que cuida da equipe e dos processos. Voc√™ constr√≥i equipes fortes e garante que o trabalho flui de maneira organizada." },
            'C-I': { title: "Comunicador Criativo", desc: "A criatividade da √Åguia com o talento de comunica√ß√£o do Gato torna-o ideal para marketing e cria√ß√£o. Voc√™ tem ideias brilhantes e sabe como apresent√°-las de forma cativante." },
            'I-A': { title: "Estrategista Ousado", desc: "A vis√£o de futuro da √Åguia com a execu√ß√£o do Tubar√£o permite que voc√™ defina metas ambiciosas e trace o caminho mais r√°pido para alcan√ß√°-las, inspirando todos ao redor." },
            'I-O': { title: "Inventor Met√≥dico", desc: "A sua mente criativa de √Åguia √© fundamentada pela l√≥gica do Lobo. Voc√™ n√£o apenas tem grandes ideias, mas tamb√©m desenvolve o passo a passo para que elas se tornem realidade." },
            'I-C': { title: "Inspirador de Equipas", desc: "A vis√£o da √Åguia com o carisma do Gato torna-o um l√≠der que inspira pelo exemplo. Voc√™ une as pessoas em torno de um prop√≥sito inovador e motiva-as a colaborar." },
        };
        const allFunctionsData = {
            'Vendas': { A: { s: 'Foco em metas e competitividade para fechar neg√≥cios.', w: 'Impaci√™ncia na negocia√ß√£o pode levar a perder detalhes.' }, O: { s: 'Organiza√ß√£o do funil de vendas e follow-up preciso.', w: 'Lentid√£o para se adaptar a novas abordagens de venda.' }, C: { s: 'Cria√ß√£o de rapport e relacionamento com o cliente.', w: 'Dificuldade em pressionar para o fecho da venda.' }, I: { s: 'Busca por novos mercados e formas criativas de vender.', w: 'Falta de consist√™ncia no processo de vendas.' } },
            'RH': { A: { s: 'Foco em m√©tricas e resultados para a √°rea.', w: 'Baixa empatia em situa√ß√µes de conflito humano.' }, O: { s: 'Cria√ß√£o de processos de RH justos e organizados.', w: 'Burocracia excessiva que limita a gest√£o de pessoas.' }, C: { s: 'Excelente comunica√ß√£o interna e gest√£o de clima.', w: 'Dificuldade em tomar decis√µes impopulares, como demiss√µes.' }, I: { s: 'Inova√ß√£o em programas de desenvolvimento e engajamento.', w: 'Falta de aten√ß√£o √†s pol√≠ticas e regras trabalhistas.' } },
            'Or√ßamento': { A: { s: 'Foco em cortar custos para atingir metas financeiras.', w: 'Pode cortar custos essenciais sem uma an√°lise profunda.' }, O: { s: 'Aten√ß√£o aos detalhes para garantir a precis√£o or√ßamental.', w: 'Rigidez excessiva perante imprevistos ou necessidades de ajuste.' }, C: { s: 'Habilidade de negocia√ß√£o com departamentos para definir or√ßamentos justos.', w: 'Dificuldade em ser firme e dizer "n√£o" a pedidos extraor√ßamentais.' }, I: { s: 'Vis√£o para alocar recursos em projetos inovadores e de crescimento.', w: 'Pode subestimar os custos reais de implementa√ß√£o de novas ideias.' } },
            'Assist√™ncia T√©cnica': { A: { s: 'Agilidade para diagnosticar e resolver problemas rapidamente.', w: 'Falta de paci√™ncia para ouvir toda a reclama√ß√£o do cliente.' }, O: { s: 'Segue um m√©todo passo a passo para garantir que nada falhe.', w: 'Dificuldade em improvisar quando o problema √© totalmente novo.' }, C: { s: 'Empatia e paci√™ncia para acalmar clientes frustrados e garantir a satisfa√ß√£o.', w: 'Pode absorver a frustra√ß√£o do cliente e prometer solu√ß√µes invi√°veis.' }, I: { s: 'Pensa em solu√ß√µes criativas e fora da caixa para os problemas t√©cnicos.', w: 'Pode complicar solu√ß√µes que poderiam ser mais simples e diretas.' } },
            'Startup': { A: { s: 'Foco agressivo no crescimento r√°pido e na conquista de mercado.', w: 'Risco de esgotar a equipe e os recursos na √¢nsia por resultados.' }, O: { s: 'Cria√ß√£o de uma base s√≥lida de processos desde o in√≠cio.', w: 'Lentid√£o na adapta√ß√£o, o que pode ser fatal num ambiente de startup.' }, C: { s: 'Cria√ß√£o de uma cultura de equipe forte e de uma boa rede de contactos.', w: 'Foco excessivo na harmonia, evitando conflitos necess√°rios ao crescimento.' }, I: { s: 'Vis√£o disruptiva para criar algo verdadeiramente novo no mercado.', w: 'Dificuldade em focar num √∫nico produto ou servi√ßo (MVP).' } },
            'Projetos': { A: { s: 'Garantia de entrega no prazo e foco no resultado final.', w: 'Pressionar a equipe excessivamente, ignorando o bem-estar.' }, O: { s: 'Planeamento detalhado, controlo de escopo e de riscos.', w: 'Falta de flexibilidade para lidar com mudan√ßas inesperadas no projeto.' }, C: { s: 'Manter a equipe unida e comunicativa durante todo o projeto.', w: 'Evitar conversas dif√≠ceis sobre prazos e responsabilidades.' }, I: { s: 'Trazer solu√ß√µes criativas para os problemas que surgem no projeto.', w: 'Perder o foco nos detalhes cr√≠ticos da execu√ß√£o.' } },
            'Programador': { A: { s: 'Entrega r√°pida de funcionalidades (sprints agressivos).', w: 'A qualidade do c√≥digo pode ser sacrificada pela velocidade.' }, O: { s: 'L√≥gica e m√©todo para criar c√≥digo limpo e bem documentado.', w: 'Resist√™ncia a adotar novas tecnologias ou frameworks.' }, C: { s: 'Excelente em pair programming e colabora√ß√£o com a equipe.', w: 'Dificuldade em trabalhar focado por longos per√≠odos sozinho.' }, I: { s: 'Gosta de experimentar novas arquiteturas e tecnologias.', w: 'Pode criar solu√ß√µes demasiado complexas para problemas simples.' } },
            'Montagem': { A: { s: 'Foco em atingir as metas de produ√ß√£o di√°rias a todo o custo.', w: 'Pode ignorar pequenos erros de qualidade para n√£o parar a linha.' }, O: { s: 'Segue os procedimentos de montagem com m√°xima precis√£o e rigor.', w: 'Baixa velocidade e dificuldade em adaptar-se a mudan√ßas no processo.' }, C: { s: 'Ajuda a manter o bom ambiente e o esp√≠rito de equipe na linha de produ√ß√£o.', w: 'Pode distrair-se com conversas, diminuindo a produtividade.' }, I: { s: 'Prop√µe melhorias e novas formas de otimizar a montagem.', w: 'Impaci√™ncia com a natureza repetitiva do trabalho.' } },
            'Estoque': { A: { s: 'Agilidade para acelerar a entrada e sa√≠da de materiais.', w: 'Risco de erros de contagem devido √† pressa.' }, O: { s: 'Controlo e organiza√ß√£o impec√°vel do invent√°rio.', w: 'Burocracia excessiva para a retirada de materiais.' }, C: { s: 'Bom relacionamento com as equipes que dependem do estoque.', w: 'Dificuldade em ser rigoroso com as regras de retirada.' }, I: { s: 'Pensa em novos sistemas de automa√ß√£o para o estoque.', w: 'Pode desorganizar o sistema atual ao tentar implementar algo novo.' } },
            'PCP': { A: { s: 'Foco em garantir que a produ√ß√£o cumpra as metas agressivas.', w: 'Cria planos irrealistas que pressionam a equipe.' }, O: { s: 'Planeamento detalhado e preciso da produ√ß√£o.', w: 'Planos muito r√≠gidos e com pouca margem para imprevistos.' }, C: { s: 'Comunica√ß√£o eficiente entre produ√ß√£o, vendas e estoque.', w: 'Tenta agradar a todos, criando planos com prazos frouxos.' }, I: { s: 'Vis√£o para planear a introdu√ß√£o de novos produtos na linha.', w: 'Falta de aten√ß√£o aos detalhes operacionais do dia a dia.' } },
            'Qualidade': { A: { s: 'Foco em resolver rapidamente os problemas de qualidade.', w: 'Pode aprovar solu√ß√µes "suficientes", mas n√£o ideais.' }, O: { s: 'Busca pela perfei√ß√£o e cria√ß√£o de padr√µes de qualidade rigorosos.', w: 'Perfeccionismo que pode atrasar a liberta√ß√£o de produtos.' }, C: { s: 'Boa comunica√ß√£o para treinar as equipes em padr√µes de qualidade.', w: 'Dificuldade em apontar falhas diretamente aos colegas.' }, I: { s: 'Pensa em novas formas de garantir a qualidade (automa√ß√£o, IA).', w: 'Pode ignorar os m√©todos de teste tradicionais e essenciais.' } },
            'Faturamento': { A: { s: 'Agilidade para garantir que as faturas sejam emitidas e pagas rapidamente.', w: 'Risco de erros nos detalhes por causa da pressa.' }, O: { s: 'Precis√£o absoluta nos valores e dados fiscais.', w: 'Processo lento e burocr√°tico que pode atrasar o faturamento.' }, C: { s: 'Bom relacionamento com clientes para a cobran√ßa amig√°vel.', w: 'Dificuldade em ser incisivo com clientes inadimplentes.' }, I: { s: 'Busca por novas plataformas e automa√ß√µes para o processo.', w: 'Pode complicar um processo que precisa de ser simples e seguro.' } },
            'P&D': { A: { s: 'Foco em transformar a pesquisa num produto vend√°vel rapidamente.', w: 'Pode apressar a fase de pesquisa, pulando etapas importantes.' }, O: { s: 'M√©todo cient√≠fico rigoroso na pesquisa e documenta√ß√£o.', w: 'Pode ficar preso na fase de pesquisa por demasiado tempo (paralisia por an√°lise).' }, C: { s: 'Colabora√ß√£o com outras equipes para entender as necessidades do mercado.', w: 'Pode ser influenciado por opini√µes em vez de dados concretos.' }, I: { s: 'Criatividade e curiosidade para explorar territ√≥rios desconhecidos.', w: 'Dificuldade em focar a pesquisa numa dire√ß√£o com potencial comercial.' } },
            'L√≠der': { A: { s: 'Lideran√ßa diretiva, focada em entregar metas.', w: 'Microgest√£o e falta de delega√ß√£o de poder.' }, O: { s: 'Lideran√ßa pelo exemplo, com organiza√ß√£o e m√©todo.', w: 'Resist√™ncia a novas ideias vindas da equipe.' }, C: { s: 'Lideran√ßa servidora, que apoia e desenvolve a equipe.', w: 'Falta de assertividade para cobrar resultados e dar feedbacks.' }, I: { s: 'Lideran√ßa inspiradora, que motiva pela vis√£o e prop√≥sito.', w: 'Comunica√ß√£o vaga e falta de clareza nas dire√ß√µes.' } },
            'CEO': { A: { s: 'Foco agressivo em crescimento e resultados financeiros.', w: 'Ignorar a cultura da empresa e o bem-estar dos colaboradores.' }, O: { s: 'Cria√ß√£o de uma empresa s√≥lida, com processos e governan√ßa.', w: 'Lentid√£o para tomar decis√µes estrat√©gicas ousadas.' }, C: { s: 'Ser o principal porta-voz e motivador da empresa.', w: 'Dificuldade em tomar decis√µes puramente racionais e duras.' }, I: { s: 'Liderar a empresa com uma vis√£o de futuro e inova√ß√£o.', w: 'Distanciar-se da realidade operacional e financeira do neg√≥cio.' } },
        };
        const interactionTips = {
            A: { O: { synergy: "A sua determina√ß√£o acelera a execu√ß√£o, enquanto a organiza√ß√£o do Lobo garante a qualidade.", attention: "Respeite a necessidade de planeamento do Lobo, evitando pressionar por decis√µes apressadas." }, C: { synergy: "Voc√™ define a dire√ß√£o e a meta, enquanto o Gato engaja e motiva a equipe.", attention: "Cuidado para n√£o parecer demasiado autorit√°rio, o que pode desmotivar o Gato." }, I: { synergy: "A vis√£o inovadora da √Åguia, combinada com a sua capacidade de execu√ß√£o, transforma ideias em realidade.", attention: "D√™ liberdade criativa √† √Åguia, sem microgerir." } },
            O: { A: { synergy: "A sua organiza√ß√£o garante a qualidade, enquanto a determina√ß√£o do Tubar√£o acelera a execu√ß√£o.", attention: "Entenda a necessidade de agilidade do Tubar√£o e foque-se nos dados essenciais." }, C: { synergy: "Voc√™ estrutura o trabalho, enquanto o Gato mant√©m a equipe unida e motivada.", attention: "Seja mais aberto √† flexibilidade que o Gato traz." }, I: { synergy: "A vis√£o criativa da √Åguia, combinada com o seu m√©todo, permite que grandes ideias sejam implementadas.", attention: "Esteja aberto √†s novas abordagens da √Åguia, mesmo que fujam ao plano." } },
            C: { A: { synergy: "O seu carisma engaja a equipe, enquanto a for√ßa do Tubar√£o garante o foco nos resultados.", attention: "Seja mais direto na comunica√ß√£o com o Tubar√£o, especialmente em feedbacks." }, O: { synergy: "Voc√™ mant√©m a equipe unida, enquanto o Lobo estrutura o trabalho e alinha a todos.", attention: "Valorize a import√¢ncia dos processos que o Lobo define." }, I: { synergy: "A sua capacidade de comunica√ß√£o, unida √† criatividade da √Åguia, √© ideal para marketing e inova√ß√£o.", attention: "Ajude a √Åguia a manter o foco e a comunicar as suas ideias de forma clara." } },
            I: { A: { synergy: "A sua vis√£o inovadora, combinada com a execu√ß√£o do Tubar√£o, transforma ideias em realidade.", attention: "Traduza as suas vis√µes em planos com metas claras para que o Tubar√£o possa agir." }, O: { synergy: "A sua vis√£o criativa, combinada com o m√©todo do Lobo, permite implementar grandes ideias.", attention: "Respeite a import√¢ncia da an√°lise de riscos que o Lobo faz." }, C: { synergy: "A sua vis√£o inovadora, combinada com o carisma do Gato, inspira e une as pessoas.", attention: "Comunique as suas ideias de forma clara para que o Gato possa engajar a equipe." } }
        };
        const developmentPlanData = {
            A: { O: { intro: "Sua for√ßa est√° na a√ß√£o (Tubar√£o ü¶à), mas pode beneficiar da organiza√ß√£o do Lobo (üê∫).", actions: ["Dedique 15 minutos para delinear um plano antes de um projeto.", "Pe√ßa a um colega met√≥dico para rever seu plano.", "Tente seguir uma rotina matinal por uma semana."] }, C: { intro: "Sua determina√ß√£o (Tubar√£o ü¶à) √© poderosa. Desenvolver a empatia (Gato üêà) o tornar√° um l√≠der completo.", actions: ["Na pr√≥xima reuni√£o, proponha-se a ouvir mais do que fala.", "Elogie publicamente um colega esta semana.", "Pergunte como algu√©m est√° antes de pedir algo."] }, I: { intro: "Seu foco em resultados (Tubar√£o ü¶à) √© excecional. Equilibre-o com a vis√£o da √Åguia (ü¶Ö).", actions: ["Reserve 30 minutos por semana para pensar em novas tend√™ncias.", "Pense em tr√™s solu√ß√µes 'fora da caixa' para um problema.", "Pergunte 'E se...?' mais vezes nas discuss√µes."] } },
            O: { A: { intro: "Sua organiza√ß√£o (Lobo üê∫) √© impec√°vel. O desafio √© aumentar a velocidade de decis√£o (Tubar√£o ü¶à).", actions: ["D√™ a si mesmo um prazo de 5 minutos para sua pr√≥xima pequena decis√£o.", "Aceite o 'bom o suficiente' em vez de 100% dos dados.", "Delegue uma pequena tarefa a um colega."] }, C: { intro: "Sua aten√ß√£o ao detalhe (Lobo üê∫) √© uma for√ßa. Fortale√ßa suas compet√™ncias de relacionamento (Gato üêà).", actions: ["Participe numa conversa informal com colegas.", "Ofere√ßa ajuda a um colega num projeto.", "Comece um feedback reconhecendo um ponto positivo."] }, I: { intro: "Seu m√©todo (Lobo üê∫) garante qualidade. Abrace um pouco da criatividade da √Åguia (ü¶Ö).", actions: ["Questione: 'Qual seria a forma diferente de fazer isto?'.", "Consuma conte√∫do fora da sua √°rea de especializa√ß√£o.", "Reserve tempo para brainstorming sem julgamento."] } },
            C: { A: { intro: "Sua capacidade de conectar pessoas (Gato üêà) √© um dom. O desafio √© ser mais assertivo (Tubar√£o ü¶à).", actions: ["Na pr√≥xima reuni√£o, seja o primeiro a partilhar sua opini√£o.", "Diga 'n√£o' a um pequeno pedido n√£o priorit√°rio.", "Expresse uma opini√£o, mesmo que discorde da maioria."] }, O: { intro: "Seu talento para colabora√ß√£o (Gato üêà) √© excecional. Adicione mais estrutura (Lobo üê∫) ao seu trabalho.", actions: ["Liste as 3 tarefas mais importantes do dia e foque-se nelas.", "Organize seus ficheiros digitais ou sua √°rea de trabalho.", "Crie um checklist para uma tarefa repetitiva."] }, I: { intro: "Sua empatia (Gato üêà) une as pessoas. Potencie-a com a vis√£o de futuro da √Åguia (ü¶Ö).", actions: ["Pergunte √† equipe: 'O que poder√≠amos estar a fazer daqui a 6 meses?'.", "Partilhe uma ideia inovadora com seu gestor.", "Assista a uma palestra online sobre o futuro da sua ind√∫stria."] } },
            I: { A: { intro: "Sua criatividade (√Åguia ü¶Ö) gera ideias brilhantes. O desafio √© traduzi-las em resultados (Tubar√£o ü¶à).", actions: ["Para sua pr√≥xima ideia, defina uma a√ß√£o execut√°vel em 24 horas.", "Pe√ßa a um colega focado em resultados para tornar sua ideia mais pr√°tica.", "Defina uma m√©trica simples para medir o sucesso da ideia."] }, O: { intro: "Sua vis√£o (√Åguia ü¶Ö) √© inspiradora. D√™ mais aten√ß√£o aos detalhes (Lobo üê∫).", actions: ["Reveja seu √∫ltimo email √† procura de erros antes de enviar.", "Crie um cronograma com pequenas etapas para uma de suas ideias.", "Pe√ßa a um colega orientado para os detalhes para rever seu trabalho."] }, C: { intro: "Suas grandes ideias (√Åguia ü¶Ö) s√£o uma for√ßa. Desenvolva a capacidade de as 'vender' (Gato üêà).", actions: ["'Venda' sua pr√≥xima ideia a um colega, focando-se nos benef√≠cios.", "Crie um grupo de brainstorming para evoluir uma ideia em conjunto.", "Pergunte ativamente o que os outros pensam das suas ideias."] } }
        };

        const integratedProfiles = {
            'A-V': { title: "O Realizador Focado", superpower: "Execu√ß√£o Visual", desc: "Voc√™ combina a determina√ß√£o do Tubar√£o com a clareza do canal Visual. Precisa visualizar o caminho at√© os resultados. Gr√°ficos e metas claras s√£o seu combust√≠vel." },
            'A-AU': { title: "O Comandante Direto", superpower: "Lideran√ßa Assertiva", desc: "Sua for√ßa de Tubar√£o √© canalizada pela comunica√ß√£o Auditiva. Voc√™ lidera com clareza, objetividade e comandos verbais diretos." },
            'A-K': { title: "O Impulsor Pr√°tico", superpower: "A√ß√£o Instintiva", desc: "Voc√™ √© a personifica√ß√£o do 'm√£o na massa'. A energia do Tubar√£o e a intui√ß√£o do Cinest√©sico o tornam impar√°vel na execu√ß√£o." },
            'O-V': { title: "O Arquiteto Detalhista", superpower: "Organiza√ß√£o Visual", desc: "A meticulosidade do Lobo se une √† percep√ß√£o Visual. Voc√™ enxerga a estrutura em tudo e precisa de planos e checklists." },
            'O-AU': { title: "O Analista L√≥gico", superpower: "Racioc√≠nio Estruturado", desc: "Voc√™ une a organiza√ß√£o do Lobo com a clareza do canal Auditivo. Seu pensamento √© linear e baseado em fatos." },
            'O-K': { title: "O Artes√£o Met√≥dico", superpower: "Qualidade Pr√°tica", desc: "A precis√£o do Lobo se manifesta atrav√©s do fazer (Cinest√©sico). Voc√™ precisa sentir a qualidade do processo e do produto." },
            'C-V': { title: "O Anfitri√£o Atencioso", superpower: "Harmonia Visual", desc: "A empatia do Gato √© refor√ßada pela aten√ß√£o aos detalhes do canal Visual. Voc√™ percebe a linguagem corporal e cria ambientes harmoniosos." },
            'C-AU': { title: "O Conector Eloquente", superpower: "Comunica√ß√£o Emp√°tica", desc: "Voc√™ √© um mestre da comunica√ß√£o. A sociabilidade do Gato e a escuta do Auditivo o tornam um excelente ouvinte e contador de hist√≥rias." },
            'C-K': { title: "O Apoiador Confi√°vel", superpower: "V√≠nculo Genu√≠no", desc: "A necessidade de conex√£o do Gato se manifesta fisicamente. Voc√™ valoriza o contato, o conforto e o bem-estar da equipe." },
            'I-V': { title: "O Vision√°rio Inspirador", superpower: "Visualiza√ß√£o Criativa", desc: "A criatividade da √Åguia se une √† capacidade de enxergar o futuro do canal Visual. Voc√™ pensa em imagens, mind maps e conceitos." },
            'I-AU': { title: "O Idealista Persuasivo", superpower: "Discurso Inovador", desc: "Suas ideias inovadoras (√Åguia) ganham vida atrav√©s da palavra (Auditivo). Voc√™ √© um excelente comunicador de novas ideias." },
            'I-K': { title: "O Explorador Intuitivo", superpower: "Inova√ß√£o Experimental", desc: "A curiosidade da √Åguia se une √† necessidade de experimentar do Cinest√©sico. Voc√™ √© um pioneiro que aprende fazendo e desbravando." }
        };
        
        const communicationStrategies = {
            'A-V': { 
                tipsForUser: ["Use gr√°ficos e checklists para delegar tarefas. Isso garante que sua equipe veja o objetivo t√£o claramente quanto voc√™.", "Antes de uma decis√£o importante, desenhe um mapa mental r√°pido dos pr√≥s e contras. Isso pode revelar pontos que voc√™ n√£o viu."],
                tipsForOthers: ["Seja direto e mostre-me dados visuais, como um gr√°fico de progresso ou um dashboard.", "Evite reuni√µes longas sem um apoio visual claro. Uma apresenta√ß√£o simples √© mais eficaz."]
            },
            'A-AU': { 
                tipsForUser: ["Ap√≥s dar uma instru√ß√£o, pe√ßa para a pessoa repetir o que entendeu. Isso garante o alinhamento.", "Module seu tom de voz. Sua objetividade √© uma for√ßa, mas um tom mais amig√°vel pode motivar mais a equipe."],
                tipsForOthers: ["V√° direto ao ponto. Apresente sua conclus√£o primeiro, e depois os detalhes, se eu perguntar.", "Use uma linguagem forte e confiante. Evite hesitar ao apresentar uma ideia."]
            },
            'A-K': { 
                tipsForUser: ["Em vez de apenas dizer o que fazer, mostre um exemplo pr√°tico. Um prot√≥tipo ou uma demonstra√ß√£o r√°pida valem mais que mil palavras.", "Reconhe√ßa que sua necessidade de 'agir agora' pode gerar ansiedade em perfis mais planejadores (Lobo). D√™ a eles um momento para se organizarem."],
                tipsForOthers: ["Se quer minha ajuda, convide-me para 'colocar a m√£o na massa' com voc√™.", "Vamos caminhar enquanto conversamos. O movimento me ajuda a pensar e a tomar decis√µes."]
            },
            'O-V': { 
                tipsForUser: ["Transforme seus planos detalhados em fluxogramas ou checklists visuais. Isso facilita a comunica√ß√£o com perfis mais diretos (Tubar√£o, √Åguia).", "Use cores para organizar suas tarefas e prioridades. A organiza√ß√£o visual aumenta sua efici√™ncia."],
                tipsForOthers: ["Apresente-me as informa√ß√µes de forma organizada e com um passo a passo claro.", "Envie-me um email com os detalhes antes da reuni√£o para que eu possa me preparar."]
            },
            'O-AU': { 
                tipsForUser: ["Leia seus e-mails importantes em voz alta antes de enviar. Isso ajuda a pegar erros e a garantir que o tom est√° correto.", "Ao explicar um processo, use uma sequ√™ncia l√≥gica clara, como 'Primeiro, fazemos X. Segundo, fazemos Y...'."],
                tipsForOthers: ["Explique o 'porqu√™' por tr√°s de uma regra ou processo. A l√≥gica me ajuda a aceitar e a seguir.", "Evite ambiguidades. Seja espec√≠fico nos seus pedidos e nas informa√ß√µes que compartilha."]
            },
            'O-K': { 
                tipsForUser: ["Crie padr√µes e modelos para suas tarefas repetitivas. Isso une sua necessidade de m√©todo (Lobo) com a efici√™ncia pr√°tica (Cinest√©sico).", "Fa√ßa pausas regulares para se alongar ou caminhar. Isso mant√©m sua energia e foco nos detalhes."],
                tipsForOthers: ["D√™-me tempo para experimentar uma nova ferramenta ou processo antes de esperar produtividade m√°xima.", "Permita-me organizar meu pr√≥prio espa√ßo de trabalho. Um ambiente f√≠sico ordenado √© crucial para mim."]
            },
            'C-V': { 
                tipsForUser: ["Preste aten√ß√£o na linguagem n√£o-verbal das pessoas. Sua sensibilidade visual (Gato-Visual) permite que voc√™ perceba o que n√£o est√° sendo dito.", "Use imagens e emojis em suas comunica√ß√µes para criar um tom mais amig√°vel e acess√≠vel."],
                tipsForOthers: ["Um ambiente de trabalho limpo e agrad√°vel me deixa mais motivado e colaborativo.", "Sorria e mantenha contato visual. Isso me mostra que voc√™ est√° conectado e aberto √† conversa."]
            },
            'C-AU': { 
                tipsForUser: ["Use sua habilidade de escuta para mediar conflitos, garantindo que todos os lados se sintam ouvidos.", "Pratique a comunica√ß√£o assertiva. √â poss√≠vel ser emp√°tico e, ao mesmo tempo, direto sobre suas necessidades e limites."],
                tipsForOthers: ["Pergunte minha opini√£o e ou√ßa genuinamente minha resposta. Sinto-me valorizado quando minhas ideias s√£o ouvidas.", "Use um tom de voz calmo e amig√°vel, especialmente ao dar feedback."]
            },
            'C-K': { 
                tipsForUser: ["Ofere√ßa ajuda pr√°tica, n√£o apenas palavras de apoio. Sua natureza Cinest√©sica o torna √≥timo em dar suporte real.", "Inicie atividades de integra√ß√£o na equipe que envolvam movimento, como um caf√© ou uma pequena comemora√ß√£o."],
                tipsForOthers: ["Um gesto de apre√ßo, como um toque no ombro (se apropriado) ou um 'high-five', significa muito para mim.", "Crie um ambiente confort√°vel. Pequenos detalhes como uma cadeira boa fazem toda a diferen√ßa para meu bem-estar."]
            },
            'I-V': { 
                tipsForUser: ["Traduza suas grandes ideias em um mapa mental ou um quadro de inspira√ß√£o. Isso ajuda os outros a 'verem' o que voc√™ v√™.", "Ao apresentar uma nova vis√£o, comece com uma imagem poderosa que represente o futuro que voc√™ imagina."],
                tipsForOthers: ["D√™-me espa√ßo em um quadro branco para rabiscar e conectar ideias. √â assim que eu penso melhor.", "Mostre-me exemplos visuais e inspira√ß√µes de outros projetos para estimular minha criatividade."]
            },
            'I-AU': { 
                tipsForUser: ["Grave suas ideias em √°udio quando estiver inspirado. Isso permite que voc√™ capture a ess√™ncia sem se perder na escrita.", "Estruture suas apresenta√ß√µes como uma hist√≥ria, com come√ßo, meio e fim. Isso torna suas ideias mais cativantes."],
                tipsForOthers: ["Vamos fazer um brainstorming verbal. Jogar ideias em voz alta me ajuda a criar e a inovar.", "N√£o me prenda a detalhes operacionais logo no in√≠cio. Deixe-me explorar o 'e se?' primeiro."]
            },
            'I-K': { 
                tipsForUser: ["Crie prot√≥tipos r√°pidos de suas ideias. Um modelo, mesmo que simples, torna sua vis√£o tang√≠vel e mais f√°cil de entender.", "Alterne entre per√≠odos de pensamento criativo e atividades f√≠sicas. Isso ajuda a manter sua energia e a gerar novos insights."],
                tipsForOthers: ["D√™-me liberdade para experimentar e testar minhas ideias na pr√°tica.", "Se quiser que eu me interesse por um projeto, deixe-me 'sentir' o seu potencial e o impacto que ele pode ter."]
            }
        };

        const improvementChecklist = {
            A: [
                "Tome uma pequena decis√£o em menos de 5 minutos hoje.",
                "Defina uma meta clara para amanh√£ e o primeiro passo para alcan√ß√°-la.",
                "Ao inv√©s de dizer 'vou tentar', diga 'vou fazer'.",
                "Inicie uma tarefa que voc√™ tem adiado.",
                "Delegue uma pequena responsabilidade a algu√©m.",
                "Comemore uma pequena vit√≥ria sua ou da equipe.",
                "Seja o primeiro a dar sua opini√£o em uma discuss√£o.",
                "Foque em terminar uma tarefa antes de come√ßar outra.",
                "Pergunte 'Qual √© o objetivo?' na pr√≥xima reuni√£o.",
                "Agrade√ßa um feedback, mesmo que seja dif√≠cil de ouvir."
            ],
            O: [
                "Arrume sua mesa ou √°rea de trabalho no final do dia.",
                "Crie uma lista com as 3 principais prioridades para amanh√£.",
                "Use uma agenda para marcar seu pr√≥ximo compromisso.",
                "Crie um checklist para uma tarefa que voc√™ faz com frequ√™ncia.",
                "Revise um e-mail importante antes de enviar.",
                "Defina um prazo para uma tarefa pessoal.",
                "Pergunte 'Qual √© o plano?' antes de iniciar um projeto.",
                "Organize uma pasta de arquivos no seu computador.",
                "Chegue 5 minutos antes para seu pr√≥ximo compromisso.",
                "Anote uma ideia ou tarefa para n√£o se esquecer."
            ],
            C: [
                "Elogie sinceramente um colega hoje.",
                "Pergunte a algu√©m como foi seu fim de semana e ou√ßa a resposta.",
                "Ofere√ßa ajuda a algu√©m, mesmo sem ser solicitado.",
                "Em uma conversa, foque mais em ouvir do que em falar.",
                "Envie uma mensagem positiva para um amigo ou familiar.",
                "Inicie uma conversa com algu√©m novo no caf√©.",
                "Agrade√ßa a algu√©m especificamente pelo seu trabalho.",
                "Participe de uma discuss√£o em grupo, mesmo que seja apenas para concordar.",
                "Pergunte a opini√£o de um colega sobre um projeto.",
                "Lembre-se do nome de algu√©m que voc√™ conheceu recentemente."
            ],
            I: [
                "Anote tr√™s ideias 'malucas' para resolver um problema.",
                "Pergunte 'E se...?' na pr√≥xima reuni√£o de equipe.",
                "Leia ou assista a algo sobre um assunto totalmente fora da sua √°rea.",
                "Tente um caminho diferente para ir ao trabalho ou para casa.",
                "Fa√ßa uma pausa de 10 minutos apenas para pensar, sem telas.",
                "Compartilhe uma ideia nova com um colega, sem medo de cr√≠ticas.",
                "Desenhe um mapa mental para organizar seus pensamentos sobre um projeto.",
                "Imagine como seu trabalho ou √°rea ser√° daqui a 5 anos.",
                "Experimente uma nova ferramenta ou aplicativo que possa ajudar no seu trabalho.",
                "Questione uma regra ou processo, pensando em como melhor√°-lo."
            ]
        };


        // --- VARI√ÅVEIS DE ESTADO ---
        let currentQuestionIndex = 0, currentTest = null, currentAnswers = [], currentQuestions = [], lastResults = {};
        let storedProfileScores = {}, storedVakScores = {};
        let clickSynth, successSynth;
        let radarChartInstance;
        
        // --- ELEMENTOS DO DOM ---
        const startScreen = document.getElementById('start-screen'), quizScreen = document.getElementById('quiz-screen'), analyzingScreen = document.getElementById('analyzing-screen'), resultsScreen = document.getElementById('results-screen'), transitionScreen = document.getElementById('transition-screen'), startBtn = document.getElementById('start-btn'), nameInput = document.getElementById('name-input'), startIconsContainer = document.getElementById('start-icons-container'), analyzingIconsContainer = document.getElementById('analyzing-icons-container'), questionContainer = document.getElementById('question-container'), questionCounter = document.getElementById('question-counter'), totalQuestions = document.getElementById('total-questions'), progressBar = document.getElementById('progress-bar'), prevBtn = document.getElementById('prev-btn'), nextBtn = document.getElementById('next-btn'), themeToggle = document.getElementById('theme-toggle'), sunIcon = document.getElementById('theme-icon-sun'), moonIcon = document.getElementById('theme-icon-moon'), validationModal = document.getElementById('validation-modal'), modalMessage = document.getElementById('modal-message'), modalCloseBtn = document.getElementById('modal-close-btn'), quizTitle = document.getElementById('quiz-title'), startVakBtn = document.getElementById('start-vak-btn'), functionModal = document.getElementById('function-modal'), functionModalTitle = document.getElementById('function-modal-title'), functionModalStrengths = document.getElementById('function-modal-strengths'), functionModalWeaknesses = document.getElementById('function-modal-weaknesses'), functionModalCloseBtn = document.getElementById('function-modal-close-btn'), interactionModal = document.getElementById('interaction-modal'), interactionModalTitle = document.getElementById('interaction-modal-title'), interactionModalSynergy = document.getElementById('interaction-modal-synergy'), interactionModalAttention = document.getElementById('interaction-modal-attention'), interactionModalCloseBtn = document.getElementById('interaction-modal-close-btn'), passwordModal = document.getElementById('password-modal'), adminBtn = document.getElementById('admin-btn'), passwordInput = document.getElementById('password-input'), passwordCancelBtn = document.getElementById('password-cancel-btn'), passwordSubmitBtn = document.getElementById('password-submit-btn'), answerKeyScreen = document.getElementById('answer-key-screen'), closeAnswerKeyBtn = document.getElementById('close-answer-key-btn'), resumeModal = document.getElementById('resume-modal'), resumeMessage = document.getElementById('resume-message'), resumeNewBtn = document.getElementById('resume-new-btn'), resumeContinueBtn = document.getElementById('resume-continue-btn');

        // --- FUN√á√ïES DE CONTROLE ---
        function initAudio() {
            if (typeof Tone !== 'undefined' && !clickSynth) {
                clickSynth = new Tone.Synth({ oscillator: { type: 'sine' }, envelope: { attack: 0.005, decay: 0.1, sustain: 0.3, release: 1 } }).toDestination();
                successSynth = new Tone.PolySynth(Tone.Synth, { oscillator: { type: 'fatsawtooth' }, envelope: { attack: 0.01, decay: 0.2, sustain: 0.2, release: 0.2 } }).toDestination();
            }
        }
        function playClickSound() { if (clickSynth && Tone.context.state === 'running') clickSynth.triggerAttackRelease('C5', '8n'); }
        function playSuccessSound() { if (successSynth && Tone.context.state === 'running') successSynth.triggerAttackRelease(['C4', 'E4', 'G4', 'C5'], '8n', Tone.now()); }

        function showScreen(screen) {
            [startScreen, quizScreen, analyzingScreen, resultsScreen, transitionScreen, answerKeyScreen].forEach(s => s.classList.add('hidden'));
            screen.classList.remove('hidden');
        }
        
        function startTest(testType) {
            currentTest = testType;
            if (testType === 'profile') {
                currentQuestions = profileTestQuestions;
                currentAnswers = new Array(profileTestQuestions.length).fill(null);
                quizTitle.textContent = "Etapa 1: Perfil Comportamental";
            } else { // VAK test
                currentQuestions = vakTestQuestions;
                currentAnswers = new Array(vakTestQuestions.length).fill(null);
                quizTitle.textContent = "Etapa 2: Canais de Comunica√ß√£o";
            }
            currentQuestionIndex = 0;
            totalQuestions.textContent = currentQuestions.length;
            showScreen(quizScreen);
            showQuestion(currentQuestionIndex);
        }

        function showQuestion(index) {
            const q = currentQuestions[index];
            if (currentTest === 'profile') {
                const questionText = q.question.substring(q.question.indexOf('.') + 1).trim();
                questionContainer.innerHTML = `<div class="question-card bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg text-center"><h2 class="text-2xl sm:text-3xl font-bold mb-8">${questionText}</h2><div class="grid grid-cols-1 sm:grid-cols-2 gap-4">${q.options.map((option, i) => `<div><input type="radio" name="question${index}" id="q${index}o${i}" value="${option.profile}" class="hidden peer" ${currentAnswers[index] === option.profile ? 'checked' : ''}><label for="q${index}o${i}" class="block cursor-pointer p-5 border border-gray-300 dark:border-gray-600 rounded-xl text-center transition-all duration-200 peer-checked:bg-blue-600 peer-checked:text-white peer-checked:border-blue-600 peer-checked:shadow-lg peer-checked:scale-105 hover:border-blue-500 dark:hover:border-blue-400">${option.text}</label></div>`).join('')}</div></div>`;
                document.querySelectorAll(`input[name="question${index}"]`).forEach(radio => radio.addEventListener('change', (e) => { 
                    playClickSound(); 
                    currentAnswers[index] = e.target.value; 
                    saveProgress();
                    setTimeout(handleNext, 200); 
                }));
            } else { // VAK test
                 questionContainer.innerHTML = `<div class="question-card bg-white dark:bg-gray-800 p-8 rounded-2xl shadow-lg text-center"><h2 class="text-2xl sm:text-3xl font-bold mb-8">${q.text}</h2><div class="flex justify-center gap-6">${['Sim', 'N√£o'].map((label, i) => `<div><input type="radio" name="question${index}" id="q${index}o${i}" value="${label === 'Sim' ? q.series : 'N'}" class="hidden peer" ${currentAnswers[index] === (label === 'Sim' ? q.series : 'N') ? 'checked' : ''}><label for="q${index}o${i}" class="block cursor-pointer px-10 py-5 border border-gray-300 dark:border-gray-600 rounded-xl text-center transition-all duration-200 peer-checked:bg-teal-600 peer-checked:text-white peer-checked:border-teal-600 peer-checked:shadow-lg peer-checked:scale-105 hover:border-teal-500 dark:hover:border-teal-400 text-xl">${label}</label></div>`).join('')}</div></div>`;
                document.querySelectorAll(`input[name="question${index}"]`).forEach(radio => radio.addEventListener('change', (e) => { 
                    playClickSound(); 
                    currentAnswers[index] = e.target.value; 
                    saveProgress();
                    setTimeout(handleNext, 200); 
                }));
            }
            updateProgress(); updateNavigation();
        }

        function updateProgress() { const answeredCount = currentAnswers.filter(a => a !== null).length; const progress = (answeredCount / currentQuestions.length) * 100; progressBar.style.width = `${progress}%`; questionCounter.textContent = currentQuestionIndex + 1; }
        
        function updateNavigation() {
            prevBtn.disabled = currentQuestionIndex === 0;
            prevBtn.classList.toggle('opacity-50', currentQuestionIndex === 0);
            const isLastQuestion = currentQuestionIndex === currentQuestions.length - 1;
            nextBtn.textContent = isLastQuestion ? 'Finalizar' : 'Pr√≥xima';
            nextBtn.classList.toggle('bg-green-600', isLastQuestion);
            nextBtn.classList.toggle('hover:bg-green-700', isLastQuestion);
            nextBtn.classList.toggle('bg-blue-600', !isLastQuestion);
            nextBtn.classList.toggle('hover:bg-blue-700', !isLastQuestion);
        }

        function handleNext() {
            if (currentAnswers[currentQuestionIndex] === null) {
                showModal(validationModal, 'Por favor, selecione uma op√ß√£o para continuar.');
                return;
            }
            if (currentQuestionIndex < currentQuestions.length - 1) {
                currentQuestionIndex++;
                showQuestion(currentQuestionIndex);
            } else {
                finishQuiz();
            }
        }
        function handlePrev() { if (currentQuestionIndex > 0) { currentQuestionIndex--; showQuestion(currentQuestionIndex); } }
        
        function finishQuiz() {
            playSuccessSound();
            if (currentTest === 'profile') {
                const scores = { 'A': 0, 'O': 0, 'C': 0, 'I': 0 }; 
                currentAnswers.forEach(answer => { if (answer) scores[answer]++; }); 
                storedProfileScores = scores;
                saveProgress();
                showScreen(transitionScreen);
            } else { // VAK
                const scores = { 'V': 0, 'AU': 0, 'K': 0 };
                currentAnswers.forEach(answer => { if (answer && answer !== 'N') scores[answer]++; });
                storedVakScores = scores;
                showScreen(analyzingScreen);
                animateAnalyzingIcons();
                setTimeout(() => {
                    displayIntegratedResults(storedProfileScores, storedVakScores);
                    clearProgress();
                }, 3500);
            }
        }
        function restartQuiz() {
            currentQuestionIndex = 0;
            currentAnswers = [];
            currentTest = null;
            storedProfileScores = {};
            storedVakScores = {};
            clearProgress();
            document.getElementById('analyzing-icons-container').classList.remove('animate-spin-roulette');
            showScreen(startScreen);
        }

        function displayIntegratedResults(profileScores, vakScores) {
            const name = nameInput.value || "Visitante";

            const sortedProfiles = Object.entries(profileScores).map(([key, score]) => ({ key, score, percentage: ((score / profileTestQuestions.length) * 100) })).sort((a, b) => b.score - a.score);
            const [dominantProfile, secondaryProfile, , lowestProfile] = sortedProfiles;
            
            const sortedVak = Object.entries(vakScores).map(([key, score]) => ({ key, score })).sort((a, b) => b.score - a.score);
            const dominantVak = sortedVak[0];
            
            const isProfileTie = sortedProfiles[0].score === sortedProfiles[1].score;
            const isVakTie = sortedVak.length > 1 && sortedVak[0].score === sortedVak[1].score;

            // Define base data, even with ties, we use the first one for logic keys
            const integratedKey = `${dominantProfile.key}-${dominantVak.key}`;
            const integratedData = integratedProfiles[integratedKey];
            const commStrategies = communicationStrategies[integratedKey];
            const checklistItems = improvementChecklist[lowestProfile.key];
            const devPlan = developmentPlanData[dominantProfile.key][lowestProfile.key];

            let finalTitle = integratedData.title;
            let finalDesc = integratedData.desc;
            let finalSuperpower = integratedData.superpower;

            if (isProfileTie) {
                const tiedProfile1 = profilesData[dominantProfile.key];
                const tiedProfile2 = profilesData[secondaryProfile.key];
                finalTitle = `Perfil H√≠brido: ${tiedProfile1.name} / ${tiedProfile2.name}`;
                finalSuperpower = "Adaptabilidade Situacional";
                finalDesc = `Voc√™ possui um equil√≠brio not√°vel entre os tra√ßos de ${tiedProfile1.name} e ${tiedProfile2.name}. Isso lhe confere uma grande versatilidade, permitindo que voc√™ se adapte a diferentes situa√ß√µes, ora usando a for√ßa de um, ora a sensibilidade do outro.`;
            }

            lastResults = { name, integratedData, dominantProfile, sortedProfiles, sortedVak, isProfileTie, isVakTie };

            resultsScreen.innerHTML = `
                <div id="pdf-content" class="bg-white dark:bg-gray-800 p-6 sm:p-8 rounded-2xl shadow-lg w-full animate-fade-in space-y-8">
                    <div class="report-section text-center">
                        <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white">An√°lise Integrada de <span class="text-blue-500">${name}</span></h2>
                        <p class="text-lg font-bold text-gray-700 dark:text-gray-300 mt-2 break-words">Seu Perfil: <span class="text-indigo-500">${finalTitle}</span></p>
                    </div>

                    <div class="report-section text-center bg-gray-50 dark:bg-gray-700/50 p-6 rounded-xl border border-gray-200 dark:border-gray-700">
                        <h3 class="font-bold text-gray-600 dark:text-gray-300 uppercase tracking-wider text-sm">Seu Superpoder</h3>
                        <p class="text-2xl font-extrabold text-indigo-500 mt-1">${finalSuperpower}</p>
                        <p class="text-gray-700 dark:text-gray-300 mt-2 max-w-3xl mx-auto">${finalDesc}</p>
                    </div>

                    <div class="report-section">
                        <h3 class="text-2xl font-bold text-center mb-4">Seu Balan√ßo Geral</h3>
                        <div class="p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div>
                                <h4 class="text-lg font-bold text-center mb-4 text-gray-700 dark:text-gray-300">Perfil Comportamental</h4>
                                <div id="profile-bars-container" class="space-y-3"></div>
                            </div>
                            <div>
                                <h4 class="text-lg font-bold text-center mb-4 text-gray-700 dark:text-gray-300">Canais de Comunica√ß√£o</h4>
                                <div id="vak-bars-container" class="space-y-3"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="report-section">
                         <h3 class="text-2xl font-bold text-center mb-4">Visualiza√ß√£o em Radar</h3>
                         <div class="p-6 bg-gray-50 dark:bg-gray-800/50 rounded-xl">
                            <div class="mx-auto max-w-md h-80">
                                <canvas id="radarChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <h3 class="text-2xl font-bold text-center mb-4">Sua Din√¢mica Comportamental</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-blue-50 dark:bg-blue-900/20 p-6 rounded-lg border border-blue-200 dark:border-blue-700">
                                ${isProfileTie ? `
                                    <h4 class="text-xl font-bold text-blue-800 dark:text-blue-300 mb-3">Perfil Dominante H√≠brido: ${profilesData[dominantProfile.key].name} ${profilesData[dominantProfile.key].emoji} / ${profilesData[secondaryProfile.key].name} ${profilesData[secondaryProfile.key].emoji}</h4>
                                    <p class="text-gray-700 dark:text-gray-300">Voc√™ n√£o tem um, mas dois perfis que se destacam com a mesma intensidade. Isso significa que voc√™ √© uma pessoa altamente adapt√°vel, capaz de alternar entre diferentes estilos de comportamento conforme a necessidade da situa√ß√£o. Sua for√ßa reside na sua flexibilidade.</p>
                                ` : `
                                    <h4 class="text-xl font-bold text-blue-800 dark:text-blue-300 mb-3">Perfil Dominante: ${profilesData[dominantProfile.key].name} ${profilesData[dominantProfile.key].emoji}</h4>
                                    <p class="text-gray-700 dark:text-gray-300">${profilesData[dominantProfile.key].description}</p>
                                `}
                            </div>
                            <div class="bg-gray-50 dark:bg-gray-700/50 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                                ${isProfileTie ? `
                                    <h4 class="text-xl font-bold text-gray-800 dark:text-gray-300 mb-3">Sua For√ßa √© o Equil√≠brio ‚öñÔ∏è</h4>
                                    <p class="text-gray-700 dark:text-gray-300">Em vez de ter um perfil secund√°rio, voc√™ tem um segundo perfil dominante. Explore a sinergia entre seus dois lados para maximizar seu potencial. Entender quando usar cada um √© a chave do seu sucesso.</p>
                                ` : `
                                    <h4 class="text-xl font-bold text-gray-800 dark:text-gray-300 mb-3">Perfil Secund√°rio: ${profilesData[secondaryProfile.key].name} ${profilesData[secondaryProfile.key].emoji}</h4>
                                    <p class="text-gray-700 dark:text-gray-300">${profilesData[secondaryProfile.key].description}</p>
                                `}
                            </div>
                        </div>
                    </div>
                    
                    <div class="report-section">
                        <h3 class="text-2xl font-bold text-center mb-4">Sua Forma de Comunicar</h3>
                        <div class="grid md:grid-cols-2 gap-6">
                            <div class="bg-teal-50 dark:bg-teal-900/20 p-6 rounded-lg border border-teal-200 dark:border-teal-700">
                                ${isVakTie ? `
                                    <h4 class="text-xl font-bold text-teal-800 dark:text-teal-300 mb-3">Seu Canal H√≠brido: ${vakProfileData[sortedVak[0].key].name} ${vakProfileData[sortedVak[0].key].emoji} / ${vakProfileData[sortedVak[1].key].name} ${vakProfileData[sortedVak[1].key].emoji}</h4>
                                    <p class="text-gray-700 dark:text-gray-300">Voc√™ tem uma comunica√ß√£o flex√≠vel, utilizando tanto elementos do canal ${vakProfileData[sortedVak[0].key].name} quanto do ${vakProfileData[sortedVak[1].key].name}. Isso permite que voc√™ se conecte com uma gama maior de pessoas, adaptando sua abordagem conforme a necessidade.</p>
                                ` : `
                                    <h4 class="text-xl font-bold text-teal-800 dark:text-teal-300 mb-3">Seu Canal Principal: ${vakProfileData[dominantVak.key].name} ${vakProfileData[dominantVak.key].emoji}</h4>
                                    <p class="text-gray-700 dark:text-gray-300">${vakProfileData[dominantVak.key].description}</p>
                                `}
                            </div>
                             <div class="bg-green-50 dark:bg-green-900/20 p-6 rounded-lg border border-green-200 dark:border-green-700">
                                <h4 class="text-xl font-bold text-green-800 dark:text-green-300 mb-3">Comunica√ß√£o e Comportamento na Pr√°tica</h4>
                                <p class="text-gray-700 dark:text-gray-300 mb-2 mt-4"><strong>Para se Potenciar (Fa√ßa Mais Disso):</strong></p>
                                <ul class="text-gray-700 dark:text-gray-300 space-y-2 list-disc list-inside">
                                    ${commStrategies.tipsForUser.map(tip => `<li>${tip}</li>`).join('')}
                                </ul>
                                <p class="text-gray-700 dark:text-gray-300 mb-2 mt-4"><strong>Pontos de Aten√ß√£o (Cuidado com Isso):</strong></p>
                                <ul class="text-gray-700 dark:text-gray-300 space-y-2 list-disc list-inside">
                                     ${commStrategies.tipsForOthers.map(tip => `<li>${tip}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    </div>


                    <!-- Tabs -->
                    <div class="report-section w-full">
                        <h3 class="text-2xl font-bold text-center mb-4">An√°lises Adicionais</h3>
                        <div class="border-b border-gray-200 dark:border-gray-700">
                            <nav id="tabs" class="-mb-px flex space-x-6 overflow-x-auto" aria-label="Tabs">
                                <button data-tab="1" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-blue-600 border-blue-600">Desenvolvimento</button>
                                <button data-tab="2" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 border-transparent">Intera√ß√£o com Perfis</button>
                                <button data-tab="3" class="tab-btn whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 border-transparent">√Åreas de Atua√ß√£o</button>
                            </nav>
                        </div>
                        <div class="py-6">
                            <div id="tab-panel-1" class="tab-panel space-y-6">
                                <div class="bg-orange-50 dark:bg-orange-900/20 p-6 rounded-lg border border-orange-200 dark:border-orange-700">
                                    <h4 class="text-xl font-bold text-orange-800 dark:text-orange-300 mb-3">Seu Foco de Desenvolvimento</h4>
                                    <p class="text-gray-700 dark:text-gray-300 mt-2">${devPlan.intro}</p>
                                    <ul class="text-gray-700 dark:text-gray-300 space-y-2 list-disc list-inside mt-2">
                                        ${devPlan.actions.map(tip => `<li>${tip}</li>`).join('')}
                                    </ul>
                                </div>
                                <div class="bg-indigo-50 dark:bg-indigo-900/20 p-6 rounded-lg border border-indigo-200 dark:border-indigo-700">
                                    <h4 class="text-xl font-bold text-indigo-800 dark:text-indigo-300 mb-3">Seu Checklist de Desenvolvimento R√°pido</h4>
                                    <p class="text-gray-700 dark:text-gray-300 mt-2">Pequenos passos para praticar e fortalecer sua √°rea de menor dom√≠nio (${profilesData[lowestProfile.key].name}).</p>
                                    <ul class="text-gray-700 dark:text-gray-300 space-y-3 mt-4">
                                        ${checklistItems.map((item, index) => `
                                            <li class="flex items-start">
                                                <input id="check-${index}" type="checkbox" class="h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500 mt-1 mr-3">
                                                <label for="check-${index}" class="text-gray-700 dark:text-gray-300">${item}</label>
                                            </li>
                                        `).join('')}
                                    </ul>
                                </div>
                            </div>
                            <div id="tab-panel-2" class="tab-panel hidden">
                                <div class="bg-gray-50 dark:bg-gray-700/50 p-6 rounded-lg border border-gray-200 dark:border-gray-600">
                                    <h4 class="text-xl font-bold text-gray-800 dark:text-gray-300 mb-4 text-center">Como voc√™ se relaciona com outros perfis</h4>
                                    <div id="interaction-buttons" class="flex flex-wrap gap-3 justify-center"></div>
                                </div>
                            </div>
                             <div id="tab-panel-3" class="tab-panel hidden">
                                <div class="bg-purple-50 dark:bg-purple-900/20 p-6 rounded-lg border border-purple-200 dark:border-purple-700">
                                    <h4 class="text-xl font-bold text-purple-800 dark:text-purple-300 mb-4 text-center">Seus pontos fortes e a melhorar em cada √°rea</h4>
                                    <div id="functions-container" class="flex flex-wrap gap-3 justify-center"></div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 flex flex-col sm:flex-row justify-center items-center gap-4">
                        <button id="share-btn" class="bg-indigo-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-indigo-700 transition-all duration-300 shadow-md transform hover:scale-105 w-full sm:w-auto flex items-center justify-center gap-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"></path></svg>
                            <span id="share-btn-text">Partilhar Imagem</span>
                        </button>
                        <button id="download-pdf-btn" class="bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 transition-all duration-300 shadow-md transform hover:scale-105 w-full sm:w-auto">Baixar Relat√≥rio</button>
                        <button id="restart-btn-results" class="bg-gray-500 text-white font-bold py-3 px-8 rounded-lg hover:bg-gray-600 transition-all duration-300 shadow-md transform hover:scale-105 w-full sm:w-auto">Refazer An√°lise</button>
                    </div>
                </div>`;
            
            // Populate bars
            const profileBarsContainer = document.getElementById('profile-bars-container');
            sortedProfiles.forEach(p => {
                const profile = profilesData[p.key];
                profileBarsContainer.innerHTML += `
                    <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-base font-medium text-gray-700 dark:text-white">${profile.emoji} ${profile.name}</span>
                            <span class="text-sm font-medium text-gray-700 dark:text-white">${p.percentage.toFixed(0)}%</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                            <div class="${profile.color} h-2.5 rounded-full" style="width: ${p.percentage}%"></div>
                        </div>
                    </div>
                `;
            });

            const vakBarsContainer = document.getElementById('vak-bars-container');
            sortedVak.forEach(v => {
                const vak = vakProfileData[v.key];
                const percentage = v.score * 10; // score is out of 10
                vakBarsContainer.innerHTML += `
                     <div>
                        <div class="flex justify-between mb-1">
                            <span class="text-base font-medium text-gray-700 dark:text-white">${vak.emoji} ${vak.name}</span>
                            <span class="text-sm font-medium text-gray-700 dark:text-white">${v.score}/10</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                            <div class="${vak.color} h-2.5 rounded-full" style="width: ${percentage}%"></div>
                        </div>
                    </div>
                `;
            });

            drawRadarChart(sortedProfiles);

            // Populate interaction buttons
            const interactionContainer = document.getElementById('interaction-buttons');
            Object.keys(profilesData).filter(key => key !== dominantProfile.key).forEach(key => {
                const profile = profilesData[key];
                interactionContainer.innerHTML += `<button data-interaction-key="${key}" class="interaction-btn bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-gray-200 text-sm font-semibold px-4 py-2 rounded-full hover:bg-gray-300 dark:hover:bg-gray-500 transition flex items-center gap-2">${profile.emoji} ${profile.name}</button>`;
            });

            // Populate function buttons
            const functionsContainer = document.getElementById('functions-container');
            Object.keys(allFunctionsData).sort().forEach(funcName => {
                functionsContainer.innerHTML += `<button data-function-name="${funcName}" class="func-btn bg-purple-100 dark:bg-purple-800 text-purple-800 dark:text-purple-200 text-sm font-semibold px-4 py-2 rounded-full hover:bg-purple-200 dark:hover:bg-purple-700 transition">${funcName}</button>`;
            });
            
            setupEventListeners();
            showScreen(resultsScreen);
        }
        
        function setupEventListeners() {
            document.getElementById('restart-btn-results').addEventListener('click', restartQuiz);
            document.getElementById('download-pdf-btn').addEventListener('click', generatePDF);
            document.getElementById('share-btn').addEventListener('click', shareResultsAsImage);

            document.querySelectorAll('.tab-btn').forEach(btn => btn.addEventListener('click', (e) => {
                const tabNum = e.target.dataset.tab;
                document.querySelectorAll('.tab-panel').forEach(p => p.classList.add('hidden'));
                document.getElementById(`tab-panel-${tabNum}`).classList.remove('hidden');
                
                document.querySelectorAll('.tab-btn').forEach(b => {
                    b.classList.remove('text-blue-600', 'border-blue-600');
                    b.classList.add('text-gray-500', 'hover:text-gray-700', 'border-transparent');
                });
                e.target.classList.add('text-blue-600', 'border-blue-600');
                e.target.classList.remove('text-gray-500', 'hover:text-gray-700', 'border-transparent');
            }));

            document.querySelectorAll('.func-btn').forEach(btn => btn.addEventListener('click', (e) => {
                const funcName = e.target.dataset.functionName;
                const dominantKey = lastResults.dominantProfile.key;
                const contextualAnalysis = allFunctionsData[funcName][dominantKey];
                functionModalTitle.textContent = funcName;
                functionModalStrengths.innerHTML = `<li>- ${contextualAnalysis.s}</li>`;
                functionModalWeaknesses.innerHTML = `<li>- ${contextualAnalysis.w}</li>`;
                showModal(functionModal);
            }));

            document.querySelectorAll('.interaction-btn').forEach(btn => btn.addEventListener('click', (e) => {
                const targetKey = e.currentTarget.dataset.interactionKey;
                const dominantKey = lastResults.dominantProfile.key;
                const interactionData = interactionTips[dominantKey][targetKey];
                interactionModalTitle.textContent = `${profilesData[dominantKey].name} interagindo com ${profilesData[targetKey].name}`;
                interactionModalSynergy.textContent = interactionData.synergy;
                interactionModalAttention.textContent = interactionData.attention;
                showModal(interactionModal);
            }));
        }

        // --- Fun√ß√µes de Desenho e Exporta√ß√£o ---
        function drawRadarChart(sortedProfiles) {
            const ctx = document.getElementById('radarChart')?.getContext('2d');
            if (!ctx) return;

            const isDarkMode = document.documentElement.classList.contains('dark');
            const gridColor = isDarkMode ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.1)';
            const fontColor = isDarkMode ? '#E5E7EB' : '#1F2937';

            const labels = ['ü¶Ö √Åguia', 'üêà Gato', 'üê∫ Lobo', 'ü¶à Tubar√£o'];
            const dataScores = { 'I': 0, 'C': 0, 'O': 0, 'A': 0 };
            sortedProfiles.forEach(p => { dataScores[p.key] = p.percentage; });
            const data = [dataScores['I'], dataScores['C'], dataScores['O'], dataScores['A']];

            if (radarChartInstance) { radarChartInstance.destroy(); }

            radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Seu Perfil',
                        data: data,
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        borderColor: 'rgba(59, 130, 246, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(59, 130, 246, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(59, 130, 246, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            angleLines: { color: gridColor },
                            grid: { color: gridColor },
                            pointLabels: {
                                font: { size: 14, family: 'Inter, sans-serif' },
                                color: fontColor
                            },
                            ticks: { display: false, stepSize: 25, max: 100, min: 0 }
                        }
                    },
                    plugins: { legend: { display: false } },
                }
            });
        }
        
        async function shareResultsAsImage() {
            const shareBtn = document.getElementById('share-btn');
            const shareBtnText = document.getElementById('share-btn-text');
            shareBtn.disabled = true;
            shareBtnText.textContent = 'A gerar...';

            const { name, integratedData, sortedProfiles, sortedVak } = lastResults;
            const dominantVakData = vakProfileData[sortedVak[0].key];

            document.getElementById('share-card-name').textContent = name;
            document.getElementById('share-card-title').textContent = `${integratedData.title} (${dominantVakData.name})`;
            document.getElementById('share-card-superpower').textContent = `Superpoder: ${integratedData.superpower}`;
            
            const percentagesContainer = document.getElementById('share-card-percentages');
            percentagesContainer.innerHTML = '';
            const profileOrder = ['I', 'C', 'O', 'A'];
            profileOrder.forEach(key => {
                const profileInfo = sortedProfiles.find(p => p.key === key);
                if(profileInfo) {
                     const profile = profilesData[profileInfo.key];
                     percentagesContainer.innerHTML += `
                        <div class="flex items-center justify-between text-left">
                            <span class="font-medium">${profile.emoji} ${profile.name}</span>
                            <span class="font-bold">${profileInfo.percentage.toFixed(0)}%</span>
                        </div>`;
                }
            });


            const chartContainer = document.getElementById('share-card-chart');
            const chartCanvas = document.createElement('canvas');
            chartContainer.innerHTML = '';
            chartContainer.appendChild(chartCanvas);

            new Chart(chartCanvas.getContext('2d'), {
                type: 'radar', 
                data: { 
                    labels: ['ü¶Ö', 'üêà', 'üê∫', 'ü¶à'], 
                    datasets: [{ 
                        data: [
                            sortedProfiles.find(p => p.key === 'I').percentage,
                            sortedProfiles.find(p => p.key === 'C').percentage,
                            sortedProfiles.find(p => p.key === 'O').percentage,
                            sortedProfiles.find(p => p.key === 'A').percentage
                        ],
                        backgroundColor: 'rgba(59, 130, 246, 0.2)', 
                        borderColor: 'rgba(59, 130, 246, 1)', 
                        borderWidth: 1.5 
                    }] 
                },
                options: { 
                    responsive: true, 
                    maintainAspectRatio: false, 
                    animation: { duration: 0 }, 
                    scales: { 
                        r: { 
                            angleLines: { color: 'rgba(0, 0, 0, 0.1)' }, 
                            grid: { color: 'rgba(0, 0, 0, 0.1)' }, 
                            pointLabels: { font: { size: 20 }, color: '#1F2937' }, 
                            ticks: { display: false, max: 100, min: 0 }
                        }
                    }, 
                    plugins: { legend: { display: false } } 
                }
            });
            
            const vakChartContainer = document.getElementById('share-card-vak-chart');
            const vakChartCanvas = document.createElement('canvas');
            vakChartContainer.innerHTML = '';
            vakChartContainer.appendChild(vakChartCanvas);

            new Chart(vakChartCanvas.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: sortedVak.map(v => `${vakProfileData[v.key].emoji} ${vakProfileData[v.key].name}`),
                    datasets: [{
                        data: sortedVak.map(v => v.score),
                        backgroundColor: sortedVak.map(v => {
                            const colorClass = vakProfileData[v.key].color;
                            if (colorClass.includes('sky')) return 'rgba(14, 165, 233, 0.7)';
                            if (colorClass.includes('teal')) return 'rgba(20, 184, 166, 0.7)';
                            if (colorClass.includes('orange')) return 'rgba(249, 115, 22, 0.7)';
                            return 'rgba(107, 114, 128, 0.7)';
                        }),
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    animation: { duration: 0 },
                    scales: {
                        x: { beginAtZero: true, max: 10, display: false },
                        y: { grid: { display: false }, ticks: { color: '#1F2937', font: { size: 12 } } }
                    },
                    plugins: { legend: { display: false }, tooltip: { enabled: false } }
                }
            });


            await new Promise(resolve => setTimeout(resolve, 500));

            const cardElement = document.getElementById('share-card');
            try {
                const canvas = await html2canvas(cardElement, { scale: 2 });
                const blob = await new Promise(resolve => canvas.toBlob(resolve, 'image/png'));
                const file = new File([blob], `perfil_${name.replace(/\s/g, '_')}.png`, { type: 'image/png' });
                if (navigator.share && navigator.canShare({ files: [file] })) {
                    await navigator.share({ title: 'Meu Perfil Integrado', text: `Descobri meu perfil: ${integratedData.title}!`, files: [file] });
                    shareBtnText.textContent = 'Partilhado!';
                } else {
                    const link = document.createElement('a');
                    link.href = URL.createObjectURL(file);
                    link.download = file.name;
                    link.click();
                    URL.revokeObjectURL(link.href);
                    shareBtnText.textContent = 'Imagem Guardada!';
                }
            } catch (error) { 
                console.error("Erro ao partilhar imagem:", error); 
                shareBtnText.textContent = 'Erro!';
            } 
            finally {
                 setTimeout(() => {
                    shareBtn.disabled = false;
                    shareBtnText.textContent = 'Partilhar Imagem';
                 }, 3000);
            }
        }

        async function generatePDF() {
            const { jsPDF } = window.jspdf;
            const downloadBtn = document.getElementById('download-pdf-btn');
            downloadBtn.textContent = 'A gerar...';
            downloadBtn.disabled = true;

            const pdf = new jsPDF('p', 'mm', 'a4');
            const pageHeight = pdf.internal.pageSize.getHeight();
            const pageWidth = pdf.internal.pageSize.getWidth();
            const margin = 15;
            let y = margin;
            
            const sections = document.querySelectorAll('.report-section');

            for (const section of sections) {
                // For√ßar o tema claro para o PDF para garantir a legibilidade
                const isDark = document.documentElement.classList.contains('dark');
                if(isDark) document.documentElement.classList.remove('dark');
                
                const canvas = await html2canvas(section, { 
                    scale: 2, 
                    useCORS: true, 
                    backgroundColor: '#ffffff'
                });

                 if(isDark) document.documentElement.classList.add('dark');
                
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = pageWidth - margin * 2;
                const imgHeight = canvas.height * imgWidth / canvas.width;

                if (y + imgHeight + margin > pageHeight) {
                    pdf.addPage();
                    y = margin;
                }
                
                pdf.addImage(imgData, 'PNG', margin, y, imgWidth, imgHeight);
                y += imgHeight + 10;
            }

            pdf.save(`Relatorio_Perfil_${lastResults.name.replace(/\s/g, '_')}.pdf`);
            downloadBtn.textContent = 'Baixar Relat√≥rio';
            downloadBtn.disabled = false;
        }
        
        function showAnswerKey() {
            const tableBody = document.getElementById('answer-key-body');
            tableBody.innerHTML = '';
            profileTestQuestions.forEach((q, index) => {
                let rowHTML = `<tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700">
                                <td class="py-4 px-6 font-medium text-gray-900 whitespace-nowrap dark:text-white">${index + 1}</td>`;
                const findOptionText = (profile) => q.options.find(opt => opt.profile === profile).text || '';
                
                rowHTML += `<td class="py-4 px-6">${findOptionText('I')}</td>`;
                rowHTML += `<td class="py-4 px-6">${findOptionText('C')}</td>`;
                rowHTML += `<td class="py-4 px-6">${findOptionText('O')}</td>`;
                rowHTML += `<td class="py-4 px-6">${findOptionText('A')}</td>`;
                rowHTML += `</tr>`;
                tableBody.innerHTML += rowHTML;
            });

            const tableBodyVak = document.getElementById('answer-key-body-vak');
            tableBodyVak.innerHTML = '';
            vakTestQuestions.forEach((q, index) => {
                const vakProfile = vakProfileData[q.series];
                let rowHTML = `<tr class="bg-white border-b dark:bg-gray-800 dark:border-gray-700">
                                <td class="py-4 px-6 font-medium text-gray-900 whitespace-nowrap dark:text-white">${index + 1}</td>
                                <td class="py-4 px-6">${q.text}</td>
                                <td class="py-4 px-6">${vakProfile.emoji} ${vakProfile.name}</td>
                               </tr>`;
                tableBodyVak.innerHTML += rowHTML;
            });

            showScreen(answerKeyScreen);
        }

        function populateIcons() {
            const iconContainer = document.querySelector('.icon-circle-container');
            const allEmojis = { ...profilesData, ...vakProfileData };
            const iconOrder = ['I', 'V', 'C', 'O', 'AU', 'A', 'K'];
            const radius = 120; // raio do c√≠rculo
            const centerX = 150; // centro X do container
            const centerY = 150; // centro Y do container

            iconOrder.forEach((key, index) => {
                const angle = (index / iconOrder.length) * 2 * Math.PI - (Math.PI / 2); // Come√ßa do topo
                const x = centerX + radius * Math.cos(angle) - 32; // 32 √© metade da largura do √≠cone
                const y = centerY + radius * Math.sin(angle) - 32; // 32 √© metade da altura do √≠cone
                
                const delay = index * 150;

                const iconDiv = document.createElement('div');
                iconDiv.className = 'icon-item absolute flex justify-center items-center bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl shadow-lg p-4 animate-float';
                iconDiv.style.left = `${x}px`;
                iconDiv.style.top = `${y}px`;
                iconDiv.style.animationDelay = `${delay}ms`;
                iconDiv.innerHTML = `<span class="text-4xl">${allEmojis[key].emoji}</span>`;
                iconContainer.appendChild(iconDiv);
            });
        }
        
        function animateAnalyzingIcons() {
            const iconContainer = document.getElementById('analyzing-icons-container');
            iconContainer.innerHTML = ''; 
            iconContainer.classList.add('animate-spin-roulette');

            const allEmojis = { ...profilesData, ...vakProfileData };
            const iconOrder = ['I', 'V', 'C', 'O', 'AU', 'A', 'K'];
            const radius = 120;
            const centerX = 150;
            const centerY = 150;

            iconOrder.forEach((key, index) => {
                const angle = (index / iconOrder.length) * 2 * Math.PI - (Math.PI / 2);
                const x = centerX + radius * Math.cos(angle) - 32;
                const y = centerY + radius * Math.sin(angle) - 32;
                
                const delay = index * 100;

                const iconDiv = document.createElement('div');
                iconDiv.className = 'analyzing-icon absolute flex justify-center items-center bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm rounded-2xl shadow-lg p-4';
                iconDiv.style.left = `${x}px`;
                iconDiv.style.top = `${y}px`;
                iconDiv.style.animationDelay = `${delay}ms`;
                iconDiv.innerHTML = `<span class="text-4xl">${allEmojis[key].emoji}</span>`;
                iconContainer.appendChild(iconDiv);
            });
        }

        // --- PROGRESS SAVING ---
        function saveProgress() {
            const progress = {
                name: nameInput.value,
                currentTest: currentTest,
                currentQuestionIndex: currentQuestionIndex,
                currentAnswers: currentAnswers,
                storedProfileScores: storedProfileScores
            };
            localStorage.setItem('quizProgress', JSON.stringify(progress));
        }

        function loadProgress() {
            const savedProgress = localStorage.getItem('quizProgress');
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                resumeMessage.textContent = `Ol√°, ${progress.name || 'visitante'}! Encontr√°mos um teste em andamento. Deseja continuar?`;
                showModal(resumeModal);

                resumeContinueBtn.onclick = async () => {
                    if (typeof Tone !== 'undefined' && Tone.context.state !== 'running') await Tone.start();
                    nameInput.value = progress.name;
                    currentTest = progress.currentTest;
                    currentQuestionIndex = progress.currentQuestionIndex;
                    currentAnswers = progress.currentAnswers;
                    storedProfileScores = progress.storedProfileScores;

                    if (currentTest === 'profile' && Object.keys(storedProfileScores).length > 0) {
                         showScreen(transitionScreen);
                    } else if (currentTest === 'vak') {
                        startTest('vak');
                        currentQuestionIndex = progress.currentQuestionIndex;
                        currentAnswers = progress.currentAnswers;
                        showQuestion(currentQuestionIndex);
                    } else {
                        startTest('profile');
                        currentQuestionIndex = progress.currentQuestionIndex;
                        currentAnswers = progress.currentAnswers;
                        showQuestion(currentQuestionIndex);
                    }
                    hideModal(resumeModal);
                };

                resumeNewBtn.onclick = () => {
                    hideModal(resumeModal);
                    clearProgress();
                    nameInput.value = '';
                };

            } else {
                 showScreen(startScreen); 
            }
        }

        function clearProgress() {
            localStorage.removeItem('quizProgress');
        }


        // --- EVENT LISTENERS E INICIALIZA√á√ÉO ---
        startBtn.addEventListener('click', async () => { 
            if (nameInput.value.trim() === '') {
                showModal(validationModal, 'Por favor, digite seu nome para come√ßar.');
                return;
            }
            if (typeof Tone !== 'undefined' && Tone.context.state !== 'running') await Tone.start();
            playClickSound();
            clearProgress(); // Clear any old progress before starting new
            startTest('profile');
        });
        startVakBtn.addEventListener('click', () => { playClickSound(); startTest('vak'); });
        prevBtn.addEventListener('click', () => { playClickSound(); handlePrev(); }); 
        nextBtn.addEventListener('click', () => { playClickSound(); handleNext(); });
        modalCloseBtn.addEventListener('click', () => hideModal(validationModal)); 
        functionModalCloseBtn.addEventListener('click', () => hideModal(functionModal));
        interactionModalCloseBtn.addEventListener('click', () => hideModal(interactionModal));
        adminBtn.addEventListener('click', () => showModal(passwordModal));
        passwordCancelBtn.addEventListener('click', () => hideModal(passwordModal));
        passwordSubmitBtn.addEventListener('click', () => {
            if (passwordInput.value === 'JD123') {
                hideModal(passwordModal);
                showAnswerKey();
                passwordInput.value = '';
            } else {
                showModal(validationModal, 'Senha incorreta!');
            }
        });
        closeAnswerKeyBtn.addEventListener('click', () => showScreen(startScreen));
        
        function applyTheme(isDark) { 
            document.documentElement.classList.toggle('dark', isDark);
            sunIcon.classList.toggle('hidden', !isDark);
            moonIcon.classList.toggle('hidden', isDark);
             if (radarChartInstance) {
                const gridColor = isDark ? 'rgba(255, 255, 255, 0.2)' : 'rgba(0, 0, 0, 0.1)';
                const fontColor = isDark ? '#E5E7EB' : '#1F2937';
                radarChartInstance.options.scales.r.angleLines.color = gridColor;
                radarChartInstance.options.scales.r.grid.color = gridColor;
                radarChartInstance.options.scales.r.pointLabels.color = fontColor;
                radarChartInstance.update('none');
            }
        }

        themeToggle.addEventListener('click', () => { 
            const isDark = document.documentElement.classList.toggle('dark'); 
            localStorage.setItem('theme', isDark ? 'dark' : 'light'); 
            applyTheme(isDark);
        });

        function showModal(modal, message = '') {
            if (modal === validationModal && message) modalMessage.textContent = message;
            modal.classList.remove('hidden');
            setTimeout(() => modal.classList.remove('opacity-0'), 10);
        }
        function hideModal(modal) {
            modal.classList.add('opacity-0');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        (function() { 
            const savedTheme = localStorage.getItem('theme'); 
            applyTheme(savedTheme === 'dark'); 
            populateIcons();
            initAudio(); 
            loadProgress();
        })();
    </script>
</body>
</html>

